{"ast":null,"code":"import { mapActions } from 'vuex';\nexport default {\n  name: 'LoginView',\n  data() {\n    return {\n      email: '',\n      password: '',\n      error: null,\n      loading: false,\n      showPassword: false,\n      loginAttempts: 0,\n      isLocked: false,\n      lockCountdown: 0,\n      countdownInterval: null,\n      isPendingAccount: false,\n      isPendingAccount: false,\n      // Forgot password\n      showForgotPassword: false,\n      forgotPasswordStep: 'email',\n      // email, verify, reset, success\n      forgotPasswordEmail: '',\n      verificationCode: '',\n      newPassword: '',\n      confirmPassword: '',\n      forgotPasswordError: null,\n      sendingCode: false,\n      verifyingCode: false,\n      resettingPassword: false,\n      otpTimer: 0,\n      otpTimerInterval: null,\n      showNewPassword: false,\n      showConfirmPassword: false,\n      testVerificationCode: null,\n      // For testing only\n      emailSent: false,\n      // Track if email was sent successfully\n\n      // Simple reset password\n      showSimpleReset: false,\n      resetEmail: '',\n      newPass: '',\n      confirmPass: '',\n      resetError: null,\n      isResetting: false,\n      resetSuccess: false,\n      resetSuccessMessage: '',\n      showNewPass: false,\n      showConfirmPass: false\n    };\n  },\n  created() {\n    // Check if there's a stored login attempt count in localStorage\n    const storedAttempts = localStorage.getItem('loginAttempts');\n    if (storedAttempts) {\n      this.loginAttempts = parseInt(storedAttempts);\n    }\n\n    // Check if account is locked\n    const lockExpiry = localStorage.getItem('lockExpiry');\n    if (lockExpiry) {\n      const expiryTime = parseInt(lockExpiry);\n      const currentTime = new Date().getTime();\n      if (expiryTime > currentTime) {\n        // Account is still locked\n        this.isLocked = true;\n        this.lockCountdown = Math.ceil((expiryTime - currentTime) / 1000);\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\n\n        // Start countdown\n        this.countdownInterval = setInterval(() => {\n          this.lockCountdown--;\n          this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\n          if (this.lockCountdown <= 0) {\n            this.unlockAccount();\n          }\n        }, 1000);\n      } else {\n        // Lock has expired\n        localStorage.removeItem('lockExpiry');\n      }\n    }\n  },\n  beforeUnmount() {\n    // Clear any intervals when component is destroyed\n    if (this.countdownInterval) {\n      clearInterval(this.countdownInterval);\n    }\n    if (this.otpTimerInterval) {\n      clearInterval(this.otpTimerInterval);\n    }\n  },\n  methods: {\n    ...mapActions(['login']),\n    togglePasswordVisibility() {\n      this.showPassword = !this.showPassword;\n    },\n    async handleLogin() {\n      // Check if account is locked\n      if (this.isLocked) {\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\n        return;\n      }\n\n      // Reset pending account status on each login attempt\n      this.isPendingAccount = false;\n      this.loading = true;\n      this.error = null;\n      try {\n        await this.login({\n          email: this.email,\n          password: this.password\n        });\n\n        // Reset login attempts on successful login\n        this.loginAttempts = 0;\n        localStorage.removeItem('loginAttempts');\n        localStorage.removeItem('lockExpiry');\n\n        // Check user status to determine redirect page\n        const userStatus = localStorage.getItem('userStatus');\n        let redirectPath = '/';\n\n        // If user is headman or assistant, redirect to all-users page\n        if (userStatus === 'headman' || userStatus === 'assistant') {\n          redirectPath = '/all-users';\n        }\n\n        // Force page reload after successful login\n        window.location.href = redirectPath;\n      } catch (error) {\n        console.error('Login error:', error);\n\n        // Check if the error message contains \"locked\" or \"locked until\"\n        const errorMessage = error.response?.data?.message || '';\n        if (errorMessage.includes('locked') || errorMessage.includes('locked until')) {\n          // Override the server's lock with our own 10-second lock\n          this.lockAccount();\n          this.loading = false;\n          return;\n        }\n\n        // Check if account is pending approval\n        if (errorMessage.includes('รออนุมัติ') || errorMessage.includes('pending approval') || error.response?.data?.isPending) {\n          this.isPendingAccount = true;\n          this.error = 'บัญชีของคุณกำลังรออนุมัติ กรุณาติดต่อผู้ใหญ่บ้าน';\n          this.loginAttempts = 0; // Reset login attempts for pending accounts\n          localStorage.removeItem('loginAttempts'); // Clear from localStorage\n          this.loading = false;\n          return;\n        }\n\n        // If the error message is about invalid credentials but the account is pending\n        // This can happen when the password is wrong for a pending account\n        if (errorMessage.includes('Invalid credentials') && error.response?.data?.isPending) {\n          this.isPendingAccount = true;\n          this.error = 'บัญชีของคุณกำลังรออนุมัติ กรุณาติดต่อผู้ใหญ่บ้าน';\n          this.loginAttempts = 0; // Reset login attempts for pending accounts\n          localStorage.removeItem('loginAttempts'); // Clear from localStorage\n          this.loading = false;\n          return;\n        }\n\n        // For any other error, make sure isPendingAccount is false\n        this.isPendingAccount = false;\n        this.error = errorMessage || 'Login failed. Please try again.';\n        this.loading = false;\n\n        // Increment login attempts (we already checked for pending account above)\n        this.loginAttempts++;\n        localStorage.setItem('loginAttempts', this.loginAttempts.toString());\n\n        // Lock account after 3 failed attempts\n        if (this.loginAttempts >= 3) {\n          this.lockAccount();\n        }\n      }\n    },\n    lockAccount() {\n      this.isLocked = true;\n      this.lockCountdown = 10; // 10 seconds\n      this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\n\n      // Store login attempts and lock expiry in localStorage\n      localStorage.setItem('loginAttempts', this.loginAttempts.toString());\n      const expiryTime = new Date().getTime() + this.lockCountdown * 1000;\n      localStorage.setItem('lockExpiry', expiryTime.toString());\n\n      // Clear any existing interval\n      if (this.countdownInterval) {\n        clearInterval(this.countdownInterval);\n      }\n\n      // Start countdown\n      this.countdownInterval = setInterval(() => {\n        this.lockCountdown--;\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\n        if (this.lockCountdown <= 0) {\n          this.unlockAccount();\n        }\n      }, 1000);\n    },\n    unlockAccount() {\n      this.isLocked = false;\n      this.loginAttempts = 0;\n\n      // Clear localStorage\n      localStorage.removeItem('loginAttempts');\n      localStorage.removeItem('lockExpiry');\n\n      // Clear the interval\n      if (this.countdownInterval) {\n        clearInterval(this.countdownInterval);\n        this.countdownInterval = null;\n      }\n      this.error = 'บัญชีถูกปลดล็อคแล้ว คุณสามารถลองเข้าสู่ระบบได้อีกครั้ง';\n    },\n    // Forgot password methods\n    async sendResetCode() {\n      if (!this.forgotPasswordEmail) {\n        this.forgotPasswordError = 'Please enter your email address';\n        return;\n      }\n      this.forgotPasswordError = null;\n      this.sendingCode = true;\n      this.testVerificationCode = null; // Reset test code\n\n      try {\n        // Call API to send verification code\n        const response = await fetch('/api/auth/forgot-password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            email: this.forgotPasswordEmail\n          })\n        });\n        const data = await response.json();\n        if (response.ok) {\n          // Move to verification step\n          this.forgotPasswordStep = 'verify';\n\n          // Start OTP timer (5 minutes)\n          this.otpTimer = 300;\n          this.startOtpTimer();\n\n          // Store test verification code if provided by the API\n          if (data.code) {\n            this.testVerificationCode = data.code;\n            console.log('Test verification code:', data.code);\n          }\n\n          // Store email sent status\n          this.emailSent = data.emailSent;\n\n          // Show appropriate message\n          this.forgotPasswordError = null;\n          if (data.emailSent) {\n            this.forgotPasswordError = 'รหัสยืนยันได้ถูกส่งไปยังอีเมลของคุณแล้ว กรุณาตรวจสอบกล่องจดหมายของคุณ (รวมถึงโฟลเดอร์สแปม)';\n          }\n        } else {\n          // If we got a code but there was an error sending email, show the code\n          if (data.code) {\n            this.testVerificationCode = data.code;\n            this.forgotPasswordStep = 'verify';\n            this.otpTimer = 300;\n            this.startOtpTimer();\n          } else {\n            this.forgotPasswordError = data.message || 'Failed to send verification code';\n          }\n        }\n      } catch (error) {\n        console.error('Error sending reset code:', error);\n        this.forgotPasswordError = 'An error occurred. Please try again.';\n      } finally {\n        this.sendingCode = false;\n      }\n    },\n    startOtpTimer() {\n      // Clear any existing timer\n      if (this.otpTimerInterval) {\n        clearInterval(this.otpTimerInterval);\n      }\n\n      // Start countdown\n      this.otpTimerInterval = setInterval(() => {\n        this.otpTimer--;\n        if (this.otpTimer <= 0) {\n          clearInterval(this.otpTimerInterval);\n          this.otpTimerInterval = null;\n        }\n      }, 1000);\n    },\n    formatTime(seconds) {\n      const minutes = Math.floor(seconds / 60);\n      const remainingSeconds = seconds % 60;\n      return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;\n    },\n    async simpleResetPassword() {\n      // Validate inputs\n      if (!this.resetEmail) {\n        this.resetError = 'กรุณากรอกอีเมล';\n        return;\n      }\n      if (!this.newPass) {\n        this.resetError = 'กรุณากรอกรหัสผ่านใหม่';\n        return;\n      }\n      if (this.newPass !== this.confirmPass) {\n        this.resetError = 'รหัสผ่านไม่ตรงกัน';\n        return;\n      }\n\n      // Validate password complexity\n      if (this.newPass.length > 10) {\n        this.resetError = 'รหัสผ่านต้องมีความยาวไม่เกิน 10 ตัวอักษร';\n        return;\n      }\n      const hasUpperCase = /[A-Z]/.test(this.newPass);\n      const hasLowerCase = /[a-z]/.test(this.newPass);\n      const hasNumbers = /[0-9]/.test(this.newPass);\n      if (!hasUpperCase || !hasLowerCase || !hasNumbers) {\n        this.resetError = 'รหัสผ่านต้องประกอบด้วยตัวอักษรพิมพ์ใหญ่ ตัวอักษรพิมพ์เล็ก และตัวเลข';\n        return;\n      }\n      this.isResetting = true;\n      this.resetError = null;\n      try {\n        const response = await fetch('/api/auth/reset-password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            email: this.resetEmail,\n            newPassword: this.newPass\n          })\n        });\n        const data = await response.json();\n        if (response.ok) {\n          this.resetSuccess = true;\n          this.resetSuccessMessage = data.message || 'รหัสผ่านของคุณได้ถูกรีเซ็ตเรียบร้อยแล้ว';\n\n          // Clear form\n          this.resetEmail = '';\n          this.newPass = '';\n          this.confirmPass = '';\n        } else {\n          this.resetError = data.message || 'เกิดข้อผิดพลาดในการรีเซ็ตรหัสผ่าน';\n        }\n      } catch (error) {\n        console.error('Error resetting password:', error);\n        this.resetError = 'เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์';\n      } finally {\n        this.isResetting = false;\n      }\n    },\n    async resendCode() {\n      if (this.otpTimer > 0) return;\n      await this.sendResetCode();\n    },\n    async verifyCode() {\n      if (!this.verificationCode) {\n        this.forgotPasswordError = 'Please enter the verification code';\n        return;\n      }\n      this.forgotPasswordError = null;\n      this.verifyingCode = true;\n      try {\n        // Call API to verify code\n        const response = await fetch('/api/auth/verify-reset-code', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            email: this.forgotPasswordEmail,\n            code: this.verificationCode\n          })\n        });\n        const data = await response.json();\n        if (response.ok) {\n          // Move to reset password step\n          this.forgotPasswordStep = 'reset';\n\n          // Clear the OTP timer\n          if (this.otpTimerInterval) {\n            clearInterval(this.otpTimerInterval);\n            this.otpTimerInterval = null;\n          }\n        } else {\n          this.forgotPasswordError = data.message || 'Invalid verification code';\n        }\n      } catch (error) {\n        console.error('Error verifying code:', error);\n        this.forgotPasswordError = 'An error occurred. Please try again.';\n      } finally {\n        this.verifyingCode = false;\n      }\n    },\n    async resetPassword() {\n      if (!this.newPassword) {\n        this.forgotPasswordError = 'Please enter a new password';\n        return;\n      }\n      if (this.newPassword !== this.confirmPassword) {\n        this.forgotPasswordError = 'Passwords do not match';\n        return;\n      }\n\n      // Validate password length (max 10 characters)\n      if (this.newPassword.length > 10) {\n        this.forgotPasswordError = 'Password must be 10 characters or less';\n        return;\n      }\n\n      // Validate password complexity\n      const hasUpperCase = /[A-Z]/.test(this.newPassword);\n      const hasLowerCase = /[a-z]/.test(this.newPassword);\n      const hasNumbers = /[0-9]/.test(this.newPassword);\n      if (!hasUpperCase || !hasLowerCase || !hasNumbers) {\n        this.forgotPasswordError = 'Password must contain uppercase letters, lowercase letters, and numbers';\n        return;\n      }\n      this.forgotPasswordError = null;\n      this.resettingPassword = true;\n      try {\n        // Call API to reset password\n        const response = await fetch('/api/auth/reset-password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            email: this.forgotPasswordEmail,\n            code: this.verificationCode,\n            newPassword: this.newPassword\n          })\n        });\n        const data = await response.json();\n        if (response.ok) {\n          // Show success message\n          this.forgotPasswordStep = 'success';\n        } else {\n          this.forgotPasswordError = data.message || 'Failed to reset password';\n        }\n      } catch (error) {\n        console.error('Error resetting password:', error);\n        this.forgotPasswordError = 'An error occurred. Please try again.';\n      } finally {\n        this.resettingPassword = false;\n      }\n    },\n    closeForgotPassword() {\n      this.showForgotPassword = false;\n      this.forgotPasswordStep = 'email';\n      this.forgotPasswordEmail = '';\n      this.verificationCode = '';\n      this.newPassword = '';\n      this.confirmPassword = '';\n      this.forgotPasswordError = null;\n      if (this.otpTimerInterval) {\n        clearInterval(this.otpTimerInterval);\n        this.otpTimerInterval = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapActions","name","data","email","password","error","loading","showPassword","loginAttempts","isLocked","lockCountdown","countdownInterval","isPendingAccount","showForgotPassword","forgotPasswordStep","forgotPasswordEmail","verificationCode","newPassword","confirmPassword","forgotPasswordError","sendingCode","verifyingCode","resettingPassword","otpTimer","otpTimerInterval","showNewPassword","showConfirmPassword","testVerificationCode","emailSent","showSimpleReset","resetEmail","newPass","confirmPass","resetError","isResetting","resetSuccess","resetSuccessMessage","showNewPass","showConfirmPass","created","storedAttempts","localStorage","getItem","parseInt","lockExpiry","expiryTime","currentTime","Date","getTime","Math","ceil","setInterval","unlockAccount","removeItem","beforeUnmount","clearInterval","methods","togglePasswordVisibility","handleLogin","login","userStatus","redirectPath","window","location","href","console","errorMessage","response","message","includes","lockAccount","isPending","setItem","toString","sendResetCode","fetch","method","headers","body","JSON","stringify","json","ok","startOtpTimer","code","log","formatTime","seconds","minutes","floor","remainingSeconds","simpleResetPassword","length","hasUpperCase","test","hasLowerCase","hasNumbers","resendCode","verifyCode","resetPassword","closeForgotPassword"],"sources":["C:\\Users\\HP\\Documents\\mooban4\\frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n  <div class=\"login\">\r\n    <h1>Login</h1>\r\n    <div class=\"form-container\">\r\n      <form @submit.prevent=\"handleLogin\">\r\n        <div class=\"form-group\">\r\n          <label for=\"email\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            id=\"email\"\r\n            v-model=\"email\"\r\n            required\r\n            placeholder=\"Enter your email\"\r\n          >\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label for=\"password\">Password</label>\r\n          <div class=\"password-input-container\">\r\n            <input\r\n              :type=\"showPassword ? 'text' : 'password'\"\r\n              id=\"password\"\r\n              v-model=\"password\"\r\n              required\r\n              placeholder=\"Enter your password\"\r\n            >\r\n            <button\r\n              type=\"button\"\r\n              class=\"toggle-password-btn\"\r\n              @click=\"togglePasswordVisibility\"\r\n            >\r\n              <i :class=\"showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <button type=\"submit\" :disabled=\"loading || isLocked\">\r\n          {{ loading ? 'Logging in...' : (isLocked ? `รอ ${lockCountdown} วินาที` : 'Login') }}\r\n        </button>\r\n\r\n        <p v-if=\"error\" class=\"error-message\" :class=\"{ 'locked-message': isLocked }\">{{ error }}</p>\r\n        <p v-if=\"loginAttempts > 0 && !isLocked && !isPendingAccount\" class=\"warning-message\">\r\n          ความพยายามในการเข้าสู่ระบบที่ล้มเหลว: {{ loginAttempts }}/3\r\n        </p>\r\n      </form>\r\n\r\n      <p>\r\n        Don't have an account?\r\n        <router-link to=\"/register\" class=\"link\">Register here</router-link>\r\n      </p>\r\n      <p>\r\n        <a href=\"#\" class=\"link\" @click.prevent=\"showSimpleReset = true\">ลืมรหัสผ่าน?</a>\r\n      </p>\r\n\r\n      <!-- Simple Reset Password Form -->\r\n      <div v-if=\"showSimpleReset\" class=\"modal\">\r\n        <div class=\"modal-content\">\r\n          <span class=\"close\" @click=\"showSimpleReset = false\">&times;</span>\r\n          <h2>รีเซ็ตรหัสผ่าน</h2>\r\n\r\n          <div v-if=\"!resetSuccess\">\r\n            <div class=\"form-group\">\r\n              <label for=\"resetEmail\">อีเมล</label>\r\n              <input\r\n                type=\"email\"\r\n                id=\"resetEmail\"\r\n                v-model=\"resetEmail\"\r\n                placeholder=\"กรอกอีเมลของคุณ\"\r\n              >\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label for=\"newPass\">รหัสผ่านใหม่</label>\r\n              <div class=\"password-input-container\">\r\n                <input\r\n                  :type=\"showNewPass ? 'text' : 'password'\"\r\n                  id=\"newPass\"\r\n                  v-model=\"newPass\"\r\n                  placeholder=\"กรอกรหัสผ่านใหม่\"\r\n                >\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"toggle-password-btn\"\r\n                  @click=\"showNewPass = !showNewPass\"\r\n                >\r\n                  <i :class=\"showNewPass ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label for=\"confirmPass\">ยืนยันรหัสผ่านใหม่</label>\r\n              <div class=\"password-input-container\">\r\n                <input\r\n                  :type=\"showConfirmPass ? 'text' : 'password'\"\r\n                  id=\"confirmPass\"\r\n                  v-model=\"confirmPass\"\r\n                  placeholder=\"กรอกรหัสผ่านใหม่อีกครั้ง\"\r\n                >\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"toggle-password-btn\"\r\n                  @click=\"showConfirmPass = !showConfirmPass\"\r\n                >\r\n                  <i :class=\"showConfirmPass ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <p class=\"password-requirements\">\r\n              รหัสผ่านต้องมีความยาวไม่เกิน 10 ตัวอักษร และประกอบด้วยตัวอักษรพิมพ์ใหญ่ ตัวอักษรพิมพ์เล็ก และตัวเลข\r\n            </p>\r\n\r\n            <div v-if=\"resetError\" class=\"error-message\">{{ resetError }}</div>\r\n\r\n            <button @click=\"simpleResetPassword\" class=\"btn-primary\">\r\n              {{ isResetting ? 'กำลังรีเซ็ต...' : 'รีเซ็ตรหัสผ่าน' }}\r\n            </button>\r\n          </div>\r\n\r\n          <div v-else>\r\n            <p class=\"success-message\">{{ resetSuccessMessage }}</p>\r\n            <button @click=\"showSimpleReset = false\" class=\"btn-primary\">กลับไปยังหน้าเข้าสู่ระบบ</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Forgot Password Modal -->\r\n      <div v-if=\"showForgotPassword\" class=\"modal\">\r\n        <div class=\"modal-content\">\r\n          <span class=\"close\" @click=\"showForgotPassword = false\">&times;</span>\r\n          <h2>รีเซ็ตรหัสผ่าน</h2>\r\n\r\n          <div v-if=\"forgotPasswordStep === 'email'\">\r\n            <p>กรอกอีเมลของคุณเพื่อรับรหัสยืนยัน</p>\r\n            <div class=\"form-group\">\r\n              <input\r\n                type=\"email\"\r\n                v-model=\"forgotPasswordEmail\"\r\n                placeholder=\"กรอกอีเมลของคุณ\"\r\n                required\r\n              >\r\n            </div>\r\n            <button\r\n              @click=\"sendResetCode\"\r\n              :disabled=\"sendingCode || !forgotPasswordEmail\"\r\n              class=\"btn-primary\"\r\n            >\r\n              {{ sendingCode ? 'กำลังส่ง...' : 'ส่งรหัสยืนยัน' }}\r\n            </button>\r\n\r\n            <!-- Display verification code for testing -->\r\n            <div v-if=\"testVerificationCode\" class=\"test-code-box\">\r\n              <p>รหัสยืนยันของคุณ:</p>\r\n              <div class=\"code-display\">{{ testVerificationCode }}</div>\r\n              <p class=\"note\">กรุณาใช้รหัสนี้ในขั้นตอนถัดไป รหัสนี้จะหมดอายุใน 5 นาที</p>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"forgotPasswordStep === 'verify'\">\r\n            <p>กรอกรหัสยืนยันที่ส่งไปยังอีเมลของคุณ</p>\r\n\r\n\r\n\r\n            <div class=\"form-group otp-input\">\r\n              <input\r\n                type=\"text\"\r\n                v-model=\"verificationCode\"\r\n                placeholder=\"กรอกรหัสยืนยัน 6 หลัก\"\r\n                maxlength=\"6\"\r\n                required\r\n              >\r\n            </div>\r\n            <p class=\"timer\" v-if=\"otpTimer > 0\">รหัสจะหมดอายุใน: {{ formatTime(otpTimer) }}</p>\r\n            <button\r\n              @click=\"verifyCode\"\r\n              :disabled=\"verifyingCode || !verificationCode\"\r\n              class=\"btn-primary\"\r\n            >\r\n              {{ verifyingCode ? 'กำลังตรวจสอบ...' : 'ตรวจสอบรหัส' }}\r\n            </button>\r\n            <p>\r\n              <a href=\"#\" @click.prevent=\"resendCode\" :class=\"{ 'disabled': otpTimer > 0 }\">\r\n                {{ otpTimer > 0 ? `ส่งรหัสใหม่ใน ${formatTime(otpTimer)}` : 'ส่งรหัสใหม่' }}\r\n              </a>\r\n            </p>\r\n          </div>\r\n\r\n          <div v-if=\"forgotPasswordStep === 'reset'\">\r\n            <p>กรอกรหัสผ่านใหม่ของคุณ</p>\r\n            <div class=\"form-group\">\r\n              <input\r\n                :type=\"showNewPassword ? 'text' : 'password'\"\r\n                v-model=\"newPassword\"\r\n                placeholder=\"รหัสผ่านใหม่\"\r\n                required\r\n              >\r\n              <button\r\n                type=\"button\"\r\n                class=\"toggle-password-btn\"\r\n                @click=\"showNewPassword = !showNewPassword\"\r\n              >\r\n                <i :class=\"showNewPassword ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n              </button>\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <input\r\n                :type=\"showConfirmPassword ? 'text' : 'password'\"\r\n                v-model=\"confirmPassword\"\r\n                placeholder=\"ยืนยันรหัสผ่านใหม่\"\r\n                required\r\n              >\r\n              <button\r\n                type=\"button\"\r\n                class=\"toggle-password-btn\"\r\n                @click=\"showConfirmPassword = !showConfirmPassword\"\r\n              >\r\n                <i :class=\"showConfirmPassword ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n              </button>\r\n            </div>\r\n            <p class=\"password-requirements\">\r\n              รหัสผ่านต้องมีความยาวไม่เกิน 10 ตัวอักษร และประกอบด้วยตัวอักษรพิมพ์ใหญ่ ตัวอักษรพิมพ์เล็ก และตัวเลข\r\n            </p>\r\n            <button\r\n              @click=\"resetPassword\"\r\n              :disabled=\"resettingPassword || !newPassword || !confirmPassword || newPassword !== confirmPassword\"\r\n              class=\"btn-primary\"\r\n            >\r\n              {{ resettingPassword ? 'กำลังรีเซ็ต...' : 'รีเซ็ตรหัสผ่าน' }}\r\n            </button>\r\n          </div>\r\n\r\n          <div v-if=\"forgotPasswordStep === 'success'\">\r\n            <p class=\"success-message\">รีเซ็ตรหัสผ่านสำเร็จแล้ว!</p>\r\n            <button @click=\"closeForgotPassword\" class=\"btn-primary\">กลับไปหน้าเข้าสู่ระบบ</button>\r\n          </div>\r\n\r\n          <p v-if=\"forgotPasswordError\" class=\"error-message\">{{ forgotPasswordError }}</p>\r\n\r\n          <!-- Only show verification code in development mode or if email sending failed -->\r\n          <div v-if=\"testVerificationCode && forgotPasswordStep !== 'email' && forgotPasswordStep !== 'success' && !emailSent\" class=\"test-code-box fixed-code\">\r\n            <p>รหัสยืนยันของคุณ:</p>\r\n            <div class=\"code-display\">{{ testVerificationCode }}</div>\r\n            <p class=\"note\">กรุณาใช้รหัสนี้ด้านบน รหัสนี้จะหมดอายุใน {{ formatTime(otpTimer) }}</p>\r\n            <p class=\"note\">(รหัสนี้แสดงเนื่องจากไม่สามารถส่งอีเมลได้)</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions } from 'vuex'\r\n\r\nexport default {\r\n  name: 'LoginView',\r\n  data() {\r\n    return {\r\n      email: '',\r\n      password: '',\r\n      error: null,\r\n      loading: false,\r\n      showPassword: false,\r\n      loginAttempts: 0,\r\n      isLocked: false,\r\n      lockCountdown: 0,\r\n      countdownInterval: null,\r\n      isPendingAccount: false,\r\n      isPendingAccount: false,\r\n\r\n      // Forgot password\r\n      showForgotPassword: false,\r\n      forgotPasswordStep: 'email', // email, verify, reset, success\r\n      forgotPasswordEmail: '',\r\n      verificationCode: '',\r\n      newPassword: '',\r\n      confirmPassword: '',\r\n      forgotPasswordError: null,\r\n      sendingCode: false,\r\n      verifyingCode: false,\r\n      resettingPassword: false,\r\n      otpTimer: 0,\r\n      otpTimerInterval: null,\r\n      showNewPassword: false,\r\n      showConfirmPassword: false,\r\n      testVerificationCode: null, // For testing only\r\n      emailSent: false, // Track if email was sent successfully\r\n\r\n      // Simple reset password\r\n      showSimpleReset: false,\r\n      resetEmail: '',\r\n      newPass: '',\r\n      confirmPass: '',\r\n      resetError: null,\r\n      isResetting: false,\r\n      resetSuccess: false,\r\n      resetSuccessMessage: '',\r\n      showNewPass: false,\r\n      showConfirmPass: false\r\n    }\r\n  },\r\n  created() {\r\n    // Check if there's a stored login attempt count in localStorage\r\n    const storedAttempts = localStorage.getItem('loginAttempts');\r\n    if (storedAttempts) {\r\n      this.loginAttempts = parseInt(storedAttempts);\r\n    }\r\n\r\n    // Check if account is locked\r\n    const lockExpiry = localStorage.getItem('lockExpiry');\r\n    if (lockExpiry) {\r\n      const expiryTime = parseInt(lockExpiry);\r\n      const currentTime = new Date().getTime();\r\n\r\n      if (expiryTime > currentTime) {\r\n        // Account is still locked\r\n        this.isLocked = true;\r\n        this.lockCountdown = Math.ceil((expiryTime - currentTime) / 1000);\r\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\r\n\r\n        // Start countdown\r\n        this.countdownInterval = setInterval(() => {\r\n          this.lockCountdown--;\r\n          this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`;\r\n\r\n          if (this.lockCountdown <= 0) {\r\n            this.unlockAccount();\r\n          }\r\n        }, 1000);\r\n      } else {\r\n        // Lock has expired\r\n        localStorage.removeItem('lockExpiry');\r\n      }\r\n    }\r\n  },\r\n\r\n  beforeUnmount() {\r\n    // Clear any intervals when component is destroyed\r\n    if (this.countdownInterval) {\r\n      clearInterval(this.countdownInterval);\r\n    }\r\n    if (this.otpTimerInterval) {\r\n      clearInterval(this.otpTimerInterval);\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions(['login']),\r\n    togglePasswordVisibility() {\r\n      this.showPassword = !this.showPassword;\r\n    },\r\n    async handleLogin() {\r\n      // Check if account is locked\r\n      if (this.isLocked) {\r\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`\r\n        return\r\n      }\r\n\r\n      // Reset pending account status on each login attempt\r\n      this.isPendingAccount = false\r\n\r\n      this.loading = true\r\n      this.error = null\r\n\r\n      try {\r\n        await this.login({\r\n          email: this.email,\r\n          password: this.password\r\n        })\r\n\r\n        // Reset login attempts on successful login\r\n        this.loginAttempts = 0\r\n        localStorage.removeItem('loginAttempts')\r\n        localStorage.removeItem('lockExpiry')\r\n\r\n        // Check user status to determine redirect page\r\n        const userStatus = localStorage.getItem('userStatus');\r\n        let redirectPath = '/';\r\n\r\n        // If user is headman or assistant, redirect to all-users page\r\n        if (userStatus === 'headman' || userStatus === 'assistant') {\r\n          redirectPath = '/all-users';\r\n        }\r\n\r\n        // Force page reload after successful login\r\n        window.location.href = redirectPath;\r\n      } catch (error) {\r\n        console.error('Login error:', error)\r\n\r\n        // Check if the error message contains \"locked\" or \"locked until\"\r\n        const errorMessage = error.response?.data?.message || '';\r\n        if (errorMessage.includes('locked') || errorMessage.includes('locked until')) {\r\n          // Override the server's lock with our own 10-second lock\r\n          this.lockAccount()\r\n          this.loading = false\r\n          return\r\n        }\r\n\r\n        // Check if account is pending approval\r\n        if (errorMessage.includes('รออนุมัติ') || errorMessage.includes('pending approval') || error.response?.data?.isPending) {\r\n          this.isPendingAccount = true;\r\n          this.error = 'บัญชีของคุณกำลังรออนุมัติ กรุณาติดต่อผู้ใหญ่บ้าน';\r\n          this.loginAttempts = 0; // Reset login attempts for pending accounts\r\n          localStorage.removeItem('loginAttempts'); // Clear from localStorage\r\n          this.loading = false;\r\n          return;\r\n        }\r\n\r\n        // If the error message is about invalid credentials but the account is pending\r\n        // This can happen when the password is wrong for a pending account\r\n        if (errorMessage.includes('Invalid credentials') && error.response?.data?.isPending) {\r\n          this.isPendingAccount = true;\r\n          this.error = 'บัญชีของคุณกำลังรออนุมัติ กรุณาติดต่อผู้ใหญ่บ้าน';\r\n          this.loginAttempts = 0; // Reset login attempts for pending accounts\r\n          localStorage.removeItem('loginAttempts'); // Clear from localStorage\r\n          this.loading = false;\r\n          return;\r\n        }\r\n\r\n        // For any other error, make sure isPendingAccount is false\r\n        this.isPendingAccount = false;\r\n\r\n        this.error = errorMessage || 'Login failed. Please try again.'\r\n        this.loading = false\r\n\r\n        // Increment login attempts (we already checked for pending account above)\r\n        this.loginAttempts++\r\n        localStorage.setItem('loginAttempts', this.loginAttempts.toString())\r\n\r\n        // Lock account after 3 failed attempts\r\n        if (this.loginAttempts >= 3) {\r\n          this.lockAccount()\r\n        }\r\n      }\r\n    },\r\n\r\n    lockAccount() {\r\n      this.isLocked = true\r\n      this.lockCountdown = 10 // 10 seconds\r\n      this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`\r\n\r\n      // Store login attempts and lock expiry in localStorage\r\n      localStorage.setItem('loginAttempts', this.loginAttempts.toString())\r\n      const expiryTime = new Date().getTime() + (this.lockCountdown * 1000)\r\n      localStorage.setItem('lockExpiry', expiryTime.toString())\r\n\r\n      // Clear any existing interval\r\n      if (this.countdownInterval) {\r\n        clearInterval(this.countdownInterval)\r\n      }\r\n\r\n      // Start countdown\r\n      this.countdownInterval = setInterval(() => {\r\n        this.lockCountdown--\r\n        this.error = `บัญชีถูกล็อคชั่วคราว กรุณารอ ${this.lockCountdown} วินาที`\r\n\r\n        if (this.lockCountdown <= 0) {\r\n          this.unlockAccount()\r\n        }\r\n      }, 1000)\r\n    },\r\n\r\n    unlockAccount() {\r\n      this.isLocked = false\r\n      this.loginAttempts = 0\r\n\r\n      // Clear localStorage\r\n      localStorage.removeItem('loginAttempts')\r\n      localStorage.removeItem('lockExpiry')\r\n\r\n      // Clear the interval\r\n      if (this.countdownInterval) {\r\n        clearInterval(this.countdownInterval)\r\n        this.countdownInterval = null\r\n      }\r\n\r\n      this.error = 'บัญชีถูกปลดล็อคแล้ว คุณสามารถลองเข้าสู่ระบบได้อีกครั้ง'\r\n    },\r\n\r\n    // Forgot password methods\r\n    async sendResetCode() {\r\n      if (!this.forgotPasswordEmail) {\r\n        this.forgotPasswordError = 'Please enter your email address';\r\n        return;\r\n      }\r\n\r\n      this.forgotPasswordError = null;\r\n      this.sendingCode = true;\r\n      this.testVerificationCode = null; // Reset test code\r\n\r\n      try {\r\n        // Call API to send verification code\r\n        const response = await fetch('/api/auth/forgot-password', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({ email: this.forgotPasswordEmail })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (response.ok) {\r\n          // Move to verification step\r\n          this.forgotPasswordStep = 'verify';\r\n\r\n          // Start OTP timer (5 minutes)\r\n          this.otpTimer = 300;\r\n          this.startOtpTimer();\r\n\r\n          // Store test verification code if provided by the API\r\n          if (data.code) {\r\n            this.testVerificationCode = data.code;\r\n            console.log('Test verification code:', data.code);\r\n          }\r\n\r\n          // Store email sent status\r\n          this.emailSent = data.emailSent;\r\n\r\n          // Show appropriate message\r\n          this.forgotPasswordError = null;\r\n          if (data.emailSent) {\r\n            this.forgotPasswordError = 'รหัสยืนยันได้ถูกส่งไปยังอีเมลของคุณแล้ว กรุณาตรวจสอบกล่องจดหมายของคุณ (รวมถึงโฟลเดอร์สแปม)';\r\n          }\r\n        } else {\r\n          // If we got a code but there was an error sending email, show the code\r\n          if (data.code) {\r\n            this.testVerificationCode = data.code;\r\n            this.forgotPasswordStep = 'verify';\r\n            this.otpTimer = 300;\r\n            this.startOtpTimer();\r\n          } else {\r\n            this.forgotPasswordError = data.message || 'Failed to send verification code';\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error sending reset code:', error);\r\n        this.forgotPasswordError = 'An error occurred. Please try again.';\r\n      } finally {\r\n        this.sendingCode = false;\r\n      }\r\n    },\r\n\r\n    startOtpTimer() {\r\n      // Clear any existing timer\r\n      if (this.otpTimerInterval) {\r\n        clearInterval(this.otpTimerInterval);\r\n      }\r\n\r\n      // Start countdown\r\n      this.otpTimerInterval = setInterval(() => {\r\n        this.otpTimer--;\r\n\r\n        if (this.otpTimer <= 0) {\r\n          clearInterval(this.otpTimerInterval);\r\n          this.otpTimerInterval = null;\r\n        }\r\n      }, 1000);\r\n    },\r\n\r\n    formatTime(seconds) {\r\n      const minutes = Math.floor(seconds / 60);\r\n      const remainingSeconds = seconds % 60;\r\n      return `${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;\r\n    },\r\n\r\n    async simpleResetPassword() {\r\n      // Validate inputs\r\n      if (!this.resetEmail) {\r\n        this.resetError = 'กรุณากรอกอีเมล';\r\n        return;\r\n      }\r\n\r\n      if (!this.newPass) {\r\n        this.resetError = 'กรุณากรอกรหัสผ่านใหม่';\r\n        return;\r\n      }\r\n\r\n      if (this.newPass !== this.confirmPass) {\r\n        this.resetError = 'รหัสผ่านไม่ตรงกัน';\r\n        return;\r\n      }\r\n\r\n      // Validate password complexity\r\n      if (this.newPass.length > 10) {\r\n        this.resetError = 'รหัสผ่านต้องมีความยาวไม่เกิน 10 ตัวอักษร';\r\n        return;\r\n      }\r\n\r\n      const hasUpperCase = /[A-Z]/.test(this.newPass);\r\n      const hasLowerCase = /[a-z]/.test(this.newPass);\r\n      const hasNumbers = /[0-9]/.test(this.newPass);\r\n\r\n      if (!hasUpperCase || !hasLowerCase || !hasNumbers) {\r\n        this.resetError = 'รหัสผ่านต้องประกอบด้วยตัวอักษรพิมพ์ใหญ่ ตัวอักษรพิมพ์เล็ก และตัวเลข';\r\n        return;\r\n      }\r\n\r\n      this.isResetting = true;\r\n      this.resetError = null;\r\n\r\n      try {\r\n        const response = await fetch('/api/auth/reset-password', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({\r\n            email: this.resetEmail,\r\n            newPassword: this.newPass\r\n          })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (response.ok) {\r\n          this.resetSuccess = true;\r\n          this.resetSuccessMessage = data.message || 'รหัสผ่านของคุณได้ถูกรีเซ็ตเรียบร้อยแล้ว';\r\n\r\n          // Clear form\r\n          this.resetEmail = '';\r\n          this.newPass = '';\r\n          this.confirmPass = '';\r\n        } else {\r\n          this.resetError = data.message || 'เกิดข้อผิดพลาดในการรีเซ็ตรหัสผ่าน';\r\n        }\r\n      } catch (error) {\r\n        console.error('Error resetting password:', error);\r\n        this.resetError = 'เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์';\r\n      } finally {\r\n        this.isResetting = false;\r\n      }\r\n    },\r\n\r\n    async resendCode() {\r\n      if (this.otpTimer > 0) return;\r\n\r\n      await this.sendResetCode();\r\n    },\r\n\r\n    async verifyCode() {\r\n      if (!this.verificationCode) {\r\n        this.forgotPasswordError = 'Please enter the verification code';\r\n        return;\r\n      }\r\n\r\n      this.forgotPasswordError = null;\r\n      this.verifyingCode = true;\r\n\r\n      try {\r\n        // Call API to verify code\r\n        const response = await fetch('/api/auth/verify-reset-code', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({\r\n            email: this.forgotPasswordEmail,\r\n            code: this.verificationCode\r\n          })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (response.ok) {\r\n          // Move to reset password step\r\n          this.forgotPasswordStep = 'reset';\r\n\r\n          // Clear the OTP timer\r\n          if (this.otpTimerInterval) {\r\n            clearInterval(this.otpTimerInterval);\r\n            this.otpTimerInterval = null;\r\n          }\r\n        } else {\r\n          this.forgotPasswordError = data.message || 'Invalid verification code';\r\n        }\r\n      } catch (error) {\r\n        console.error('Error verifying code:', error);\r\n        this.forgotPasswordError = 'An error occurred. Please try again.';\r\n      } finally {\r\n        this.verifyingCode = false;\r\n      }\r\n    },\r\n\r\n    async resetPassword() {\r\n      if (!this.newPassword) {\r\n        this.forgotPasswordError = 'Please enter a new password';\r\n        return;\r\n      }\r\n\r\n      if (this.newPassword !== this.confirmPassword) {\r\n        this.forgotPasswordError = 'Passwords do not match';\r\n        return;\r\n      }\r\n\r\n      // Validate password length (max 10 characters)\r\n      if (this.newPassword.length > 10) {\r\n        this.forgotPasswordError = 'Password must be 10 characters or less';\r\n        return;\r\n      }\r\n\r\n      // Validate password complexity\r\n      const hasUpperCase = /[A-Z]/.test(this.newPassword);\r\n      const hasLowerCase = /[a-z]/.test(this.newPassword);\r\n      const hasNumbers = /[0-9]/.test(this.newPassword);\r\n\r\n      if (!hasUpperCase || !hasLowerCase || !hasNumbers) {\r\n        this.forgotPasswordError = 'Password must contain uppercase letters, lowercase letters, and numbers';\r\n        return;\r\n      }\r\n\r\n      this.forgotPasswordError = null;\r\n      this.resettingPassword = true;\r\n\r\n      try {\r\n        // Call API to reset password\r\n        const response = await fetch('/api/auth/reset-password', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: JSON.stringify({\r\n            email: this.forgotPasswordEmail,\r\n            code: this.verificationCode,\r\n            newPassword: this.newPassword\r\n          })\r\n        });\r\n\r\n        const data = await response.json();\r\n\r\n        if (response.ok) {\r\n          // Show success message\r\n          this.forgotPasswordStep = 'success';\r\n        } else {\r\n          this.forgotPasswordError = data.message || 'Failed to reset password';\r\n        }\r\n      } catch (error) {\r\n        console.error('Error resetting password:', error);\r\n        this.forgotPasswordError = 'An error occurred. Please try again.';\r\n      } finally {\r\n        this.resettingPassword = false;\r\n      }\r\n    },\r\n\r\n    closeForgotPassword() {\r\n      this.showForgotPassword = false;\r\n      this.forgotPasswordStep = 'email';\r\n      this.forgotPasswordEmail = '';\r\n      this.verificationCode = '';\r\n      this.newPassword = '';\r\n      this.confirmPassword = '';\r\n      this.forgotPasswordError = null;\r\n\r\n      if (this.otpTimerInterval) {\r\n        clearInterval(this.otpTimerInterval);\r\n        this.otpTimerInterval = null;\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.login {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 80vh;\r\n  padding: 20px;\r\n}\r\n\r\n.form-container {\r\n  width: 100%;\r\n  max-width: 400px;\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  padding: 30px;\r\n}\r\n\r\nh1 {\r\n  text-align: center;\r\n  color: #333;\r\n  margin-bottom: 30px;\r\n  font-size: 28px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 8px;\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #4CAF50;\r\n  outline: none;\r\n  box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);\r\n}\r\n\r\nbutton[type=\"submit\"] {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n  margin-top: 10px;\r\n}\r\n\r\nbutton[type=\"submit\"]:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\nbutton[type=\"submit\"]:disabled {\r\n  background-color: #9e9e9e;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.error-message {\r\n  color: #f44336;\r\n  margin-top: 15px;\r\n  text-align: center;\r\n}\r\n\r\n.locked-message {\r\n  color: #ff9800;\r\n  font-weight: bold;\r\n}\r\n\r\n.warning-message {\r\n  color: #ff9800;\r\n  margin-top: 10px;\r\n  text-align: center;\r\n  font-size: 14px;\r\n}\r\n\r\np {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n  color: #666;\r\n}\r\n\r\n.link {\r\n  color: #4CAF50;\r\n  text-decoration: none;\r\n  font-weight: 500;\r\n}\r\n\r\n.link:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.password-input-container {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.password-input-container input {\r\n  width: 100%;\r\n  padding-right: 40px; /* Make room for the button */\r\n}\r\n\r\n.toggle-password-btn {\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  background: none;\r\n  border: none;\r\n  color: #666;\r\n  cursor: pointer;\r\n  padding: 5px;\r\n  font-size: 16px;\r\n}\r\n\r\n.toggle-password-btn:hover {\r\n  color: #333;\r\n}\r\n\r\n.toggle-password-btn:focus {\r\n  outline: none;\r\n}\r\n\r\n/* Modal styles */\r\n.modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.test-code-box {\r\n  background-color: #f8f9fa;\r\n  border: 1px dashed #4CAF50;\r\n  border-radius: 5px;\r\n  padding: 15px;\r\n  margin: 15px 0;\r\n  text-align: center;\r\n}\r\n\r\n.fixed-code {\r\n  position: sticky;\r\n  top: 10px;\r\n  z-index: 100;\r\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\r\n  background-color: #f0f8f0;\r\n  border: 2px solid #4CAF50;\r\n}\r\n\r\n.code-display {\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  letter-spacing: 5px;\r\n  color: #4CAF50;\r\n  margin: 10px 0;\r\n  background-color: #fff;\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n  border: 1px solid #e0e0e0;\r\n}\r\n\r\n.note {\r\n  font-size: 12px;\r\n  color: #666;\r\n  font-style: italic;\r\n  margin-top: 10px;\r\n}\r\n\r\n.modal-content {\r\n  background-color: white;\r\n  padding: 30px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\r\n  width: 90%;\r\n  max-width: 400px;\r\n  position: relative;\r\n}\r\n\r\n.close {\r\n  position: absolute;\r\n  top: 15px;\r\n  right: 20px;\r\n  font-size: 24px;\r\n  cursor: pointer;\r\n  color: #666;\r\n}\r\n\r\n.close:hover {\r\n  color: #333;\r\n}\r\n\r\n.modal h2 {\r\n  margin-top: 0;\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.otp-input input {\r\n  letter-spacing: 4px;\r\n  font-size: 18px;\r\n  text-align: center;\r\n}\r\n\r\n.timer {\r\n  text-align: center;\r\n  color: #666;\r\n  font-size: 14px;\r\n  margin: 10px 0;\r\n}\r\n\r\n.success-message {\r\n  color: #4CAF50;\r\n  text-align: center;\r\n  font-weight: bold;\r\n  margin: 20px 0;\r\n}\r\n\r\n.btn-primary {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n  margin-top: 10px;\r\n}\r\n\r\n.btn-primary:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n.btn-primary:disabled {\r\n  background-color: #9e9e9e;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.password-requirements {\r\n  font-size: 12px;\r\n  color: #666;\r\n  margin-top: 5px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\na.disabled {\r\n  color: #999;\r\n  cursor: not-allowed;\r\n  text-decoration: none;\r\n}\r\n\r\n.test-code-box {\r\n  background-color: #f8f9fa;\r\n  border: 1px dashed #ccc;\r\n  border-radius: 5px;\r\n  padding: 15px;\r\n  margin: 15px 0;\r\n  text-align: center;\r\n}\r\n\r\n.test-code {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  letter-spacing: 5px;\r\n  color: #4CAF50;\r\n  margin: 10px 0;\r\n  background-color: #fff;\r\n  padding: 10px;\r\n  border-radius: 4px;\r\n  border: 1px solid #e0e0e0;\r\n}\r\n\r\n.test-note {\r\n  font-size: 12px;\r\n  color: #666;\r\n  font-style: italic;\r\n  margin-top: 10px;\r\n}\r\n</style>"],"mappings":"AA6PA,SAASA,UAAS,QAAS,MAAK;AAEhC,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,IAAI;MACXC,OAAO,EAAE,KAAK;MACdC,YAAY,EAAE,KAAK;MACnBC,aAAa,EAAE,CAAC;MAChBC,QAAQ,EAAE,KAAK;MACfC,aAAa,EAAE,CAAC;MAChBC,iBAAiB,EAAE,IAAI;MACvBC,gBAAgB,EAAE,KAAK;MACvBA,gBAAgB,EAAE,KAAK;MAEvB;MACAC,kBAAkB,EAAE,KAAK;MACzBC,kBAAkB,EAAE,OAAO;MAAE;MAC7BC,mBAAmB,EAAE,EAAE;MACvBC,gBAAgB,EAAE,EAAE;MACpBC,WAAW,EAAE,EAAE;MACfC,eAAe,EAAE,EAAE;MACnBC,mBAAmB,EAAE,IAAI;MACzBC,WAAW,EAAE,KAAK;MAClBC,aAAa,EAAE,KAAK;MACpBC,iBAAiB,EAAE,KAAK;MACxBC,QAAQ,EAAE,CAAC;MACXC,gBAAgB,EAAE,IAAI;MACtBC,eAAe,EAAE,KAAK;MACtBC,mBAAmB,EAAE,KAAK;MAC1BC,oBAAoB,EAAE,IAAI;MAAE;MAC5BC,SAAS,EAAE,KAAK;MAAE;;MAElB;MACAC,eAAe,EAAE,KAAK;MACtBC,UAAU,EAAE,EAAE;MACdC,OAAO,EAAE,EAAE;MACXC,WAAW,EAAE,EAAE;MACfC,UAAU,EAAE,IAAI;MAChBC,WAAW,EAAE,KAAK;MAClBC,YAAY,EAAE,KAAK;MACnBC,mBAAmB,EAAE,EAAE;MACvBC,WAAW,EAAE,KAAK;MAClBC,eAAe,EAAE;IACnB;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,MAAMC,cAAa,GAAIC,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;IAC5D,IAAIF,cAAc,EAAE;MAClB,IAAI,CAAChC,aAAY,GAAImC,QAAQ,CAACH,cAAc,CAAC;IAC/C;;IAEA;IACA,MAAMI,UAAS,GAAIH,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;IACrD,IAAIE,UAAU,EAAE;MACd,MAAMC,UAAS,GAAIF,QAAQ,CAACC,UAAU,CAAC;MACvC,MAAME,WAAU,GAAI,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MAExC,IAAIH,UAAS,GAAIC,WAAW,EAAE;QAC5B;QACA,IAAI,CAACrC,QAAO,GAAI,IAAI;QACpB,IAAI,CAACC,aAAY,GAAIuC,IAAI,CAACC,IAAI,CAAC,CAACL,UAAS,GAAIC,WAAW,IAAI,IAAI,CAAC;QACjE,IAAI,CAACzC,KAAI,GAAI,gCAAgC,IAAI,CAACK,aAAa,SAAS;;QAExE;QACA,IAAI,CAACC,iBAAgB,GAAIwC,WAAW,CAAC,MAAM;UACzC,IAAI,CAACzC,aAAa,EAAE;UACpB,IAAI,CAACL,KAAI,GAAI,gCAAgC,IAAI,CAACK,aAAa,SAAS;UAExE,IAAI,IAAI,CAACA,aAAY,IAAK,CAAC,EAAE;YAC3B,IAAI,CAAC0C,aAAa,CAAC,CAAC;UACtB;QACF,CAAC,EAAE,IAAI,CAAC;MACV,OAAO;QACL;QACAX,YAAY,CAACY,UAAU,CAAC,YAAY,CAAC;MACvC;IACF;EACF,CAAC;EAEDC,aAAaA,CAAA,EAAG;IACd;IACA,IAAI,IAAI,CAAC3C,iBAAiB,EAAE;MAC1B4C,aAAa,CAAC,IAAI,CAAC5C,iBAAiB,CAAC;IACvC;IACA,IAAI,IAAI,CAACa,gBAAgB,EAAE;MACzB+B,aAAa,CAAC,IAAI,CAAC/B,gBAAgB,CAAC;IACtC;EACF,CAAC;EAEDgC,OAAO,EAAE;IACP,GAAGxD,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC;IACxByD,wBAAwBA,CAAA,EAAG;MACzB,IAAI,CAAClD,YAAW,GAAI,CAAC,IAAI,CAACA,YAAY;IACxC,CAAC;IACD,MAAMmD,WAAWA,CAAA,EAAG;MAClB;MACA,IAAI,IAAI,CAACjD,QAAQ,EAAE;QACjB,IAAI,CAACJ,KAAI,GAAI,gCAAgC,IAAI,CAACK,aAAa,SAAQ;QACvE;MACF;;MAEA;MACA,IAAI,CAACE,gBAAe,GAAI,KAAI;MAE5B,IAAI,CAACN,OAAM,GAAI,IAAG;MAClB,IAAI,CAACD,KAAI,GAAI,IAAG;MAEhB,IAAI;QACF,MAAM,IAAI,CAACsD,KAAK,CAAC;UACfxD,KAAK,EAAE,IAAI,CAACA,KAAK;UACjBC,QAAQ,EAAE,IAAI,CAACA;QACjB,CAAC;;QAED;QACA,IAAI,CAACI,aAAY,GAAI;QACrBiC,YAAY,CAACY,UAAU,CAAC,eAAe;QACvCZ,YAAY,CAACY,UAAU,CAAC,YAAY;;QAEpC;QACA,MAAMO,UAAS,GAAInB,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;QACrD,IAAImB,YAAW,GAAI,GAAG;;QAEtB;QACA,IAAID,UAAS,KAAM,SAAQ,IAAKA,UAAS,KAAM,WAAW,EAAE;UAC1DC,YAAW,GAAI,YAAY;QAC7B;;QAEA;QACAC,MAAM,CAACC,QAAQ,CAACC,IAAG,GAAIH,YAAY;MACrC,EAAE,OAAOxD,KAAK,EAAE;QACd4D,OAAO,CAAC5D,KAAK,CAAC,cAAc,EAAEA,KAAK;;QAEnC;QACA,MAAM6D,YAAW,GAAI7D,KAAK,CAAC8D,QAAQ,EAAEjE,IAAI,EAAEkE,OAAM,IAAK,EAAE;QACxD,IAAIF,YAAY,CAACG,QAAQ,CAAC,QAAQ,KAAKH,YAAY,CAACG,QAAQ,CAAC,cAAc,CAAC,EAAE;UAC5E;UACA,IAAI,CAACC,WAAW,CAAC;UACjB,IAAI,CAAChE,OAAM,GAAI,KAAI;UACnB;QACF;;QAEA;QACA,IAAI4D,YAAY,CAACG,QAAQ,CAAC,WAAW,KAAKH,YAAY,CAACG,QAAQ,CAAC,kBAAkB,KAAKhE,KAAK,CAAC8D,QAAQ,EAAEjE,IAAI,EAAEqE,SAAS,EAAE;UACtH,IAAI,CAAC3D,gBAAe,GAAI,IAAI;UAC5B,IAAI,CAACP,KAAI,GAAI,kDAAkD;UAC/D,IAAI,CAACG,aAAY,GAAI,CAAC,EAAE;UACxBiC,YAAY,CAACY,UAAU,CAAC,eAAe,CAAC,EAAE;UAC1C,IAAI,CAAC/C,OAAM,GAAI,KAAK;UACpB;QACF;;QAEA;QACA;QACA,IAAI4D,YAAY,CAACG,QAAQ,CAAC,qBAAqB,KAAKhE,KAAK,CAAC8D,QAAQ,EAAEjE,IAAI,EAAEqE,SAAS,EAAE;UACnF,IAAI,CAAC3D,gBAAe,GAAI,IAAI;UAC5B,IAAI,CAACP,KAAI,GAAI,kDAAkD;UAC/D,IAAI,CAACG,aAAY,GAAI,CAAC,EAAE;UACxBiC,YAAY,CAACY,UAAU,CAAC,eAAe,CAAC,EAAE;UAC1C,IAAI,CAAC/C,OAAM,GAAI,KAAK;UACpB;QACF;;QAEA;QACA,IAAI,CAACM,gBAAe,GAAI,KAAK;QAE7B,IAAI,CAACP,KAAI,GAAI6D,YAAW,IAAK,iCAAgC;QAC7D,IAAI,CAAC5D,OAAM,GAAI,KAAI;;QAEnB;QACA,IAAI,CAACE,aAAa,EAAC;QACnBiC,YAAY,CAAC+B,OAAO,CAAC,eAAe,EAAE,IAAI,CAAChE,aAAa,CAACiE,QAAQ,CAAC,CAAC;;QAEnE;QACA,IAAI,IAAI,CAACjE,aAAY,IAAK,CAAC,EAAE;UAC3B,IAAI,CAAC8D,WAAW,CAAC;QACnB;MACF;IACF,CAAC;IAEDA,WAAWA,CAAA,EAAG;MACZ,IAAI,CAAC7D,QAAO,GAAI,IAAG;MACnB,IAAI,CAACC,aAAY,GAAI,EAAC,EAAE;MACxB,IAAI,CAACL,KAAI,GAAI,gCAAgC,IAAI,CAACK,aAAa,SAAQ;;MAEvE;MACA+B,YAAY,CAAC+B,OAAO,CAAC,eAAe,EAAE,IAAI,CAAChE,aAAa,CAACiE,QAAQ,CAAC,CAAC;MACnE,MAAM5B,UAAS,GAAI,IAAIE,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,IAAK,IAAI,CAACtC,aAAY,GAAI,IAAI;MACpE+B,YAAY,CAAC+B,OAAO,CAAC,YAAY,EAAE3B,UAAU,CAAC4B,QAAQ,CAAC,CAAC;;MAExD;MACA,IAAI,IAAI,CAAC9D,iBAAiB,EAAE;QAC1B4C,aAAa,CAAC,IAAI,CAAC5C,iBAAiB;MACtC;;MAEA;MACA,IAAI,CAACA,iBAAgB,GAAIwC,WAAW,CAAC,MAAM;QACzC,IAAI,CAACzC,aAAa,EAAC;QACnB,IAAI,CAACL,KAAI,GAAI,gCAAgC,IAAI,CAACK,aAAa,SAAQ;QAEvE,IAAI,IAAI,CAACA,aAAY,IAAK,CAAC,EAAE;UAC3B,IAAI,CAAC0C,aAAa,CAAC;QACrB;MACF,CAAC,EAAE,IAAI;IACT,CAAC;IAEDA,aAAaA,CAAA,EAAG;MACd,IAAI,CAAC3C,QAAO,GAAI,KAAI;MACpB,IAAI,CAACD,aAAY,GAAI;;MAErB;MACAiC,YAAY,CAACY,UAAU,CAAC,eAAe;MACvCZ,YAAY,CAACY,UAAU,CAAC,YAAY;;MAEpC;MACA,IAAI,IAAI,CAAC1C,iBAAiB,EAAE;QAC1B4C,aAAa,CAAC,IAAI,CAAC5C,iBAAiB;QACpC,IAAI,CAACA,iBAAgB,GAAI,IAAG;MAC9B;MAEA,IAAI,CAACN,KAAI,GAAI,wDAAuD;IACtE,CAAC;IAED;IACA,MAAMqE,aAAaA,CAAA,EAAG;MACpB,IAAI,CAAC,IAAI,CAAC3D,mBAAmB,EAAE;QAC7B,IAAI,CAACI,mBAAkB,GAAI,iCAAiC;QAC5D;MACF;MAEA,IAAI,CAACA,mBAAkB,GAAI,IAAI;MAC/B,IAAI,CAACC,WAAU,GAAI,IAAI;MACvB,IAAI,CAACO,oBAAmB,GAAI,IAAI,EAAE;;MAElC,IAAI;QACF;QACA,MAAMwC,QAAO,GAAI,MAAMQ,KAAK,CAAC,2BAA2B,EAAE;UACxDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YAAE7E,KAAK,EAAE,IAAI,CAACY;UAAoB,CAAC;QAC1D,CAAC,CAAC;QAEF,MAAMb,IAAG,GAAI,MAAMiE,QAAQ,CAACc,IAAI,CAAC,CAAC;QAElC,IAAId,QAAQ,CAACe,EAAE,EAAE;UACf;UACA,IAAI,CAACpE,kBAAiB,GAAI,QAAQ;;UAElC;UACA,IAAI,CAACS,QAAO,GAAI,GAAG;UACnB,IAAI,CAAC4D,aAAa,CAAC,CAAC;;UAEpB;UACA,IAAIjF,IAAI,CAACkF,IAAI,EAAE;YACb,IAAI,CAACzD,oBAAmB,GAAIzB,IAAI,CAACkF,IAAI;YACrCnB,OAAO,CAACoB,GAAG,CAAC,yBAAyB,EAAEnF,IAAI,CAACkF,IAAI,CAAC;UACnD;;UAEA;UACA,IAAI,CAACxD,SAAQ,GAAI1B,IAAI,CAAC0B,SAAS;;UAE/B;UACA,IAAI,CAACT,mBAAkB,GAAI,IAAI;UAC/B,IAAIjB,IAAI,CAAC0B,SAAS,EAAE;YAClB,IAAI,CAACT,mBAAkB,GAAI,4FAA4F;UACzH;QACF,OAAO;UACL;UACA,IAAIjB,IAAI,CAACkF,IAAI,EAAE;YACb,IAAI,CAACzD,oBAAmB,GAAIzB,IAAI,CAACkF,IAAI;YACrC,IAAI,CAACtE,kBAAiB,GAAI,QAAQ;YAClC,IAAI,CAACS,QAAO,GAAI,GAAG;YACnB,IAAI,CAAC4D,aAAa,CAAC,CAAC;UACtB,OAAO;YACL,IAAI,CAAChE,mBAAkB,GAAIjB,IAAI,CAACkE,OAAM,IAAK,kCAAkC;UAC/E;QACF;MACF,EAAE,OAAO/D,KAAK,EAAE;QACd4D,OAAO,CAAC5D,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,IAAI,CAACc,mBAAkB,GAAI,sCAAsC;MACnE,UAAU;QACR,IAAI,CAACC,WAAU,GAAI,KAAK;MAC1B;IACF,CAAC;IAED+D,aAAaA,CAAA,EAAG;MACd;MACA,IAAI,IAAI,CAAC3D,gBAAgB,EAAE;QACzB+B,aAAa,CAAC,IAAI,CAAC/B,gBAAgB,CAAC;MACtC;;MAEA;MACA,IAAI,CAACA,gBAAe,GAAI2B,WAAW,CAAC,MAAM;QACxC,IAAI,CAAC5B,QAAQ,EAAE;QAEf,IAAI,IAAI,CAACA,QAAO,IAAK,CAAC,EAAE;UACtBgC,aAAa,CAAC,IAAI,CAAC/B,gBAAgB,CAAC;UACpC,IAAI,CAACA,gBAAe,GAAI,IAAI;QAC9B;MACF,CAAC,EAAE,IAAI,CAAC;IACV,CAAC;IAED8D,UAAUA,CAACC,OAAO,EAAE;MAClB,MAAMC,OAAM,GAAIvC,IAAI,CAACwC,KAAK,CAACF,OAAM,GAAI,EAAE,CAAC;MACxC,MAAMG,gBAAe,GAAIH,OAAM,GAAI,EAAE;MACrC,OAAO,GAAGC,OAAO,IAAIE,gBAAe,GAAI,EAAC,GAAI,GAAE,GAAI,EAAE,GAAGA,gBAAgB,EAAE;IAC5E,CAAC;IAED,MAAMC,mBAAmBA,CAAA,EAAG;MAC1B;MACA,IAAI,CAAC,IAAI,CAAC7D,UAAU,EAAE;QACpB,IAAI,CAACG,UAAS,GAAI,gBAAgB;QAClC;MACF;MAEA,IAAI,CAAC,IAAI,CAACF,OAAO,EAAE;QACjB,IAAI,CAACE,UAAS,GAAI,uBAAuB;QACzC;MACF;MAEA,IAAI,IAAI,CAACF,OAAM,KAAM,IAAI,CAACC,WAAW,EAAE;QACrC,IAAI,CAACC,UAAS,GAAI,mBAAmB;QACrC;MACF;;MAEA;MACA,IAAI,IAAI,CAACF,OAAO,CAAC6D,MAAK,GAAI,EAAE,EAAE;QAC5B,IAAI,CAAC3D,UAAS,GAAI,0CAA0C;QAC5D;MACF;MAEA,MAAM4D,YAAW,GAAI,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC/D,OAAO,CAAC;MAC/C,MAAMgE,YAAW,GAAI,OAAO,CAACD,IAAI,CAAC,IAAI,CAAC/D,OAAO,CAAC;MAC/C,MAAMiE,UAAS,GAAI,OAAO,CAACF,IAAI,CAAC,IAAI,CAAC/D,OAAO,CAAC;MAE7C,IAAI,CAAC8D,YAAW,IAAK,CAACE,YAAW,IAAK,CAACC,UAAU,EAAE;QACjD,IAAI,CAAC/D,UAAS,GAAI,qEAAqE;QACvF;MACF;MAEA,IAAI,CAACC,WAAU,GAAI,IAAI;MACvB,IAAI,CAACD,UAAS,GAAI,IAAI;MAEtB,IAAI;QACF,MAAMkC,QAAO,GAAI,MAAMQ,KAAK,CAAC,0BAA0B,EAAE;UACvDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnB7E,KAAK,EAAE,IAAI,CAAC2B,UAAU;YACtBb,WAAW,EAAE,IAAI,CAACc;UACpB,CAAC;QACH,CAAC,CAAC;QAEF,MAAM7B,IAAG,GAAI,MAAMiE,QAAQ,CAACc,IAAI,CAAC,CAAC;QAElC,IAAId,QAAQ,CAACe,EAAE,EAAE;UACf,IAAI,CAAC/C,YAAW,GAAI,IAAI;UACxB,IAAI,CAACC,mBAAkB,GAAIlC,IAAI,CAACkE,OAAM,IAAK,yCAAyC;;UAEpF;UACA,IAAI,CAACtC,UAAS,GAAI,EAAE;UACpB,IAAI,CAACC,OAAM,GAAI,EAAE;UACjB,IAAI,CAACC,WAAU,GAAI,EAAE;QACvB,OAAO;UACL,IAAI,CAACC,UAAS,GAAI/B,IAAI,CAACkE,OAAM,IAAK,mCAAmC;QACvE;MACF,EAAE,OAAO/D,KAAK,EAAE;QACd4D,OAAO,CAAC5D,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,IAAI,CAAC4B,UAAS,GAAI,4CAA4C;MAChE,UAAU;QACR,IAAI,CAACC,WAAU,GAAI,KAAK;MAC1B;IACF,CAAC;IAED,MAAM+D,UAAUA,CAAA,EAAG;MACjB,IAAI,IAAI,CAAC1E,QAAO,GAAI,CAAC,EAAE;MAEvB,MAAM,IAAI,CAACmD,aAAa,CAAC,CAAC;IAC5B,CAAC;IAED,MAAMwB,UAAUA,CAAA,EAAG;MACjB,IAAI,CAAC,IAAI,CAAClF,gBAAgB,EAAE;QAC1B,IAAI,CAACG,mBAAkB,GAAI,oCAAoC;QAC/D;MACF;MAEA,IAAI,CAACA,mBAAkB,GAAI,IAAI;MAC/B,IAAI,CAACE,aAAY,GAAI,IAAI;MAEzB,IAAI;QACF;QACA,MAAM8C,QAAO,GAAI,MAAMQ,KAAK,CAAC,6BAA6B,EAAE;UAC1DC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnB7E,KAAK,EAAE,IAAI,CAACY,mBAAmB;YAC/BqE,IAAI,EAAE,IAAI,CAACpE;UACb,CAAC;QACH,CAAC,CAAC;QAEF,MAAMd,IAAG,GAAI,MAAMiE,QAAQ,CAACc,IAAI,CAAC,CAAC;QAElC,IAAId,QAAQ,CAACe,EAAE,EAAE;UACf;UACA,IAAI,CAACpE,kBAAiB,GAAI,OAAO;;UAEjC;UACA,IAAI,IAAI,CAACU,gBAAgB,EAAE;YACzB+B,aAAa,CAAC,IAAI,CAAC/B,gBAAgB,CAAC;YACpC,IAAI,CAACA,gBAAe,GAAI,IAAI;UAC9B;QACF,OAAO;UACL,IAAI,CAACL,mBAAkB,GAAIjB,IAAI,CAACkE,OAAM,IAAK,2BAA2B;QACxE;MACF,EAAE,OAAO/D,KAAK,EAAE;QACd4D,OAAO,CAAC5D,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC7C,IAAI,CAACc,mBAAkB,GAAI,sCAAsC;MACnE,UAAU;QACR,IAAI,CAACE,aAAY,GAAI,KAAK;MAC5B;IACF,CAAC;IAED,MAAM8E,aAAaA,CAAA,EAAG;MACpB,IAAI,CAAC,IAAI,CAAClF,WAAW,EAAE;QACrB,IAAI,CAACE,mBAAkB,GAAI,6BAA6B;QACxD;MACF;MAEA,IAAI,IAAI,CAACF,WAAU,KAAM,IAAI,CAACC,eAAe,EAAE;QAC7C,IAAI,CAACC,mBAAkB,GAAI,wBAAwB;QACnD;MACF;;MAEA;MACA,IAAI,IAAI,CAACF,WAAW,CAAC2E,MAAK,GAAI,EAAE,EAAE;QAChC,IAAI,CAACzE,mBAAkB,GAAI,wCAAwC;QACnE;MACF;;MAEA;MACA,MAAM0E,YAAW,GAAI,OAAO,CAACC,IAAI,CAAC,IAAI,CAAC7E,WAAW,CAAC;MACnD,MAAM8E,YAAW,GAAI,OAAO,CAACD,IAAI,CAAC,IAAI,CAAC7E,WAAW,CAAC;MACnD,MAAM+E,UAAS,GAAI,OAAO,CAACF,IAAI,CAAC,IAAI,CAAC7E,WAAW,CAAC;MAEjD,IAAI,CAAC4E,YAAW,IAAK,CAACE,YAAW,IAAK,CAACC,UAAU,EAAE;QACjD,IAAI,CAAC7E,mBAAkB,GAAI,yEAAyE;QACpG;MACF;MAEA,IAAI,CAACA,mBAAkB,GAAI,IAAI;MAC/B,IAAI,CAACG,iBAAgB,GAAI,IAAI;MAE7B,IAAI;QACF;QACA,MAAM6C,QAAO,GAAI,MAAMQ,KAAK,CAAC,0BAA0B,EAAE;UACvDC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnB7E,KAAK,EAAE,IAAI,CAACY,mBAAmB;YAC/BqE,IAAI,EAAE,IAAI,CAACpE,gBAAgB;YAC3BC,WAAW,EAAE,IAAI,CAACA;UACpB,CAAC;QACH,CAAC,CAAC;QAEF,MAAMf,IAAG,GAAI,MAAMiE,QAAQ,CAACc,IAAI,CAAC,CAAC;QAElC,IAAId,QAAQ,CAACe,EAAE,EAAE;UACf;UACA,IAAI,CAACpE,kBAAiB,GAAI,SAAS;QACrC,OAAO;UACL,IAAI,CAACK,mBAAkB,GAAIjB,IAAI,CAACkE,OAAM,IAAK,0BAA0B;QACvE;MACF,EAAE,OAAO/D,KAAK,EAAE;QACd4D,OAAO,CAAC5D,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,IAAI,CAACc,mBAAkB,GAAI,sCAAsC;MACnE,UAAU;QACR,IAAI,CAACG,iBAAgB,GAAI,KAAK;MAChC;IACF,CAAC;IAED8E,mBAAmBA,CAAA,EAAG;MACpB,IAAI,CAACvF,kBAAiB,GAAI,KAAK;MAC/B,IAAI,CAACC,kBAAiB,GAAI,OAAO;MACjC,IAAI,CAACC,mBAAkB,GAAI,EAAE;MAC7B,IAAI,CAACC,gBAAe,GAAI,EAAE;MAC1B,IAAI,CAACC,WAAU,GAAI,EAAE;MACrB,IAAI,CAACC,eAAc,GAAI,EAAE;MACzB,IAAI,CAACC,mBAAkB,GAAI,IAAI;MAE/B,IAAI,IAAI,CAACK,gBAAgB,EAAE;QACzB+B,aAAa,CAAC,IAAI,CAAC/B,gBAAgB,CAAC;QACpC,IAAI,CAACA,gBAAe,GAAI,IAAI;MAC9B;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}