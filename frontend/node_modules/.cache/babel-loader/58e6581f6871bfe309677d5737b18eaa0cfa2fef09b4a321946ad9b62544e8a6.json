{"ast":null,"code":"import api from '@/services/api';\nexport default {\n  name: 'AllUsersView',\n  data() {\n    return {\n      users: [],\n      approvers: {},\n      // Map of user IDs to names for approvers\n      loading: true,\n      error: null,\n      searchQuery: '',\n      statusFilter: '',\n      sortKey: 'user_id',\n      sortOrder: 1,\n      // 1 for ascending, -1 for descending\n      selectedUser: null,\n      editingUser: null,\n      userToDelete: null,\n      currentUserStatus: localStorage.getItem('userStatus') || '',\n      isExporting: false\n    };\n  },\n  computed: {\n    isHeadmanOrAssistant() {\n      return this.currentUserStatus === 'headman' || this.currentUserStatus === 'assistant';\n    },\n    filteredUsers() {\n      let result = [...this.users];\n\n      // Apply search filter - only by Full Name\n      if (this.searchQuery) {\n        const query = this.searchQuery.toLowerCase();\n        result = result.filter(user => {\n          const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\n          return fullName.includes(query);\n        });\n      }\n\n      // Apply status filter\n      if (this.statusFilter) {\n        result = result.filter(user => user.status === this.statusFilter);\n      }\n\n      // Apply sorting\n      result.sort((a, b) => {\n        let valueA, valueB;\n        if (this.sortKey === 'fullName') {\n          valueA = `${a.first_name} ${a.last_name}`.toLowerCase();\n          valueB = `${b.first_name} ${b.last_name}`.toLowerCase();\n        } else {\n          valueA = a[this.sortKey];\n          valueB = b[this.sortKey];\n\n          // Handle null or undefined values\n          if (valueA === null || valueA === undefined) valueA = '';\n          if (valueB === null || valueB === undefined) valueB = '';\n\n          // Convert to lowercase if string\n          if (typeof valueA === 'string') valueA = valueA.toLowerCase();\n          if (typeof valueB === 'string') valueB = valueB.toLowerCase();\n        }\n        if (valueA < valueB) return -1 * this.sortOrder;\n        if (valueA > valueB) return 1 * this.sortOrder;\n        return 0;\n      });\n      return result;\n    }\n  },\n  methods: {\n    async fetchUsers() {\n      this.loading = true;\n      try {\n        const response = await api.getAllUsers();\n        this.users = response.data.users;\n\n        // Extract unique approver IDs\n        const approverIds = [...new Set(this.users.filter(user => user.approved_by).map(user => user.approved_by))];\n\n        // Fetch approver names\n        for (const approverId of approverIds) {\n          try {\n            const response = await api.getUserById(approverId);\n            const approver = response.data;\n            this.approvers[approverId] = `${approver.first_name} ${approver.last_name}`;\n          } catch (error) {\n            console.error(`Error fetching approver ${approverId}:`, error);\n            this.approvers[approverId] = `User #${approverId}`;\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching users:', error);\n        this.error = 'Failed to load users. Please try again.';\n      } finally {\n        this.loading = false;\n      }\n    },\n    sortBy(key) {\n      if (this.sortKey === key) {\n        // If already sorting by this key, reverse the order\n        this.sortOrder = -this.sortOrder;\n      } else {\n        // Otherwise, sort by the new key in ascending order\n        this.sortKey = key;\n        this.sortOrder = 1;\n      }\n    },\n    formatStatus(status) {\n      if (!status) return 'Unknown';\n\n      // Capitalize first letter\n      return status.charAt(0).toUpperCase() + status.slice(1);\n    },\n    getStatusClass(status) {\n      if (!status) return 'status-unknown';\n      switch (status.toLowerCase()) {\n        case 'headman':\n          return 'status-headman';\n        case 'assistant':\n          return 'status-assistant';\n        case 'villager':\n          return 'status-villager';\n        case 'pending':\n          return 'status-pending';\n        default:\n          return 'status-unknown';\n      }\n    },\n    formatDate(dateString) {\n      if (!dateString) return 'N/A';\n      const date = new Date(dateString);\n      return date.toLocaleString();\n    },\n    getApproverName(approverId) {\n      return this.approvers[approverId] || `User #${approverId}`;\n    },\n    viewUser(user) {\n      this.selectedUser = {\n        ...user\n      };\n    },\n    editUser(user) {\n      this.editingUser = {\n        ...user\n      };\n    },\n    cancelEdit() {\n      this.editingUser = null;\n    },\n    async saveUser() {\n      try {\n        await api.updateUser(this.editingUser.user_id, {\n          firstName: this.editingUser.first_name,\n          lastName: this.editingUser.last_name,\n          email: this.editingUser.user_email,\n          phone: this.editingUser.phone,\n          address: this.editingUser.address,\n          status: this.editingUser.status\n        });\n\n        // Update the user in the local array\n        const index = this.users.findIndex(u => u.user_id === this.editingUser.user_id);\n        if (index !== -1) {\n          this.users[index] = {\n            ...this.editingUser\n          };\n        }\n        this.editingUser = null;\n      } catch (error) {\n        console.error('Error updating user:', error);\n        alert('Failed to update user. Please try again.');\n      }\n    },\n    confirmDelete(user) {\n      this.userToDelete = {\n        ...user\n      };\n    },\n    async deleteUser() {\n      try {\n        await api.deleteUser(this.userToDelete.user_id);\n\n        // Remove the user from the local array\n        this.users = this.users.filter(u => u.user_id !== this.userToDelete.user_id);\n        this.userToDelete = null;\n        alert('User deleted successfully');\n      } catch (error) {\n        console.error('Error deleting user:', error);\n        alert('Failed to delete user. Please try again.');\n      }\n    },\n    handleFileUpload(event) {\n      const file = event.target.files[0];\n      if (!file) return;\n\n      // Check if user has permission to import\n      if (!this.isHeadmanOrAssistant) {\n        alert('คุณไม่มีสิทธิ์ในการนำเข้าไฟล์ กรุณาติดต่อผู้ดูแลระบบ');\n        return;\n      }\n\n      // Check file type\n      const fileType = file.name.split('.').pop().toLowerCase();\n      if (!['csv', 'xlsx', 'xls'].includes(fileType)) {\n        alert('กรุณาอัปโหลดไฟล์ CSV หรือ Excel เท่านั้น');\n        return;\n      }\n\n      // Here you would normally process the file\n      // For now, we'll just show a success message\n      alert(`ไฟล์ ${file.name} ถูกอัปโหลดเรียบร้อยแล้ว (การประมวลผลจะถูกพัฒนาในเวอร์ชันถัดไป)`);\n\n      // Reset the file input\n      event.target.value = '';\n    },\n    exportToPDF() {\n      if (this.isExporting) return;\n\n      // Check if user has permission to export\n      if (!this.isHeadmanOrAssistant) {\n        alert('คุณไม่มีสิทธิ์ในการส่งออกไฟล์ กรุณาติดต่อผู้ดูแลระบบ');\n        return;\n      }\n      this.isExporting = true;\n      try {\n        // Prepare data for PDF\n        const title = 'รายชื่อพนักงานทั้งหมด';\n        const headers = ['รหัส', 'ชื่อ-นามสกุล', 'เบอร์โทรศัพท์', 'สถานะ', 'อนุมัติโดย'];\n        const data = this.filteredUsers.map(user => [user.user_id, `${user.first_name} ${user.last_name}`, user.phone || 'ไม่ระบุ', this.formatStatus(user.status), user.approved_by ? this.getApproverName(user.approved_by) : 'ยังไม่ได้รับการอนุมัติ']);\n\n        // Here you would normally generate the PDF\n        // For now, we'll just show a success message\n        alert(`กำลังส่งออกข้อมูลผู้ใช้ ${data.length} คน เป็นไฟล์ PDF (ฟังก์ชันนี้จะถูกพัฒนาในเวอร์ชันถัดไป)`);\n      } catch (error) {\n        console.error('Error exporting to PDF:', error);\n        alert('ไม่สามารถส่งออกไฟล์ PDF ได้ กรุณาลองอีกครั้ง');\n      } finally {\n        this.isExporting = false;\n      }\n    }\n  },\n  mounted() {\n    // Check if user is logged in\n    const token = localStorage.getItem('token');\n    if (!token) {\n      // Redirect to login page if not logged in\n      window.location.href = '/login';\n      return;\n    }\n    this.fetchUsers();\n  }\n};","map":{"version":3,"names":["api","name","data","users","approvers","loading","error","searchQuery","statusFilter","sortKey","sortOrder","selectedUser","editingUser","userToDelete","currentUserStatus","localStorage","getItem","isExporting","computed","isHeadmanOrAssistant","filteredUsers","result","query","toLowerCase","filter","user","fullName","first_name","last_name","includes","status","sort","a","b","valueA","valueB","undefined","methods","fetchUsers","response","getAllUsers","approverIds","Set","approved_by","map","approverId","getUserById","approver","console","sortBy","key","formatStatus","charAt","toUpperCase","slice","getStatusClass","formatDate","dateString","date","Date","toLocaleString","getApproverName","viewUser","editUser","cancelEdit","saveUser","updateUser","user_id","firstName","lastName","email","user_email","phone","address","index","findIndex","u","alert","confirmDelete","deleteUser","handleFileUpload","event","file","target","files","fileType","split","pop","value","exportToPDF","title","headers","length","mounted","token","window","location","href"],"sources":["C:\\Users\\HP\\Documents\\mooban4\\frontend\\src\\views\\AllUsersView.fixed.vue"],"sourcesContent":["<template>\r\n  <div class=\"all-users-view\">\r\n    <div class=\"header-container\">\r\n      <div class=\"title-section\">\r\n        <h1>All Employees <span class=\"user-count\">({{ filteredUsers.length }} users)</span></h1>\r\n      </div>\r\n      <div class=\"action-section\">\r\n        <label for=\"file-upload\" class=\"import-btn\">\r\n          <i class=\"fas fa-file-import\"></i> Import Excel\r\n        </label>\r\n        <input id=\"file-upload\" type=\"file\" @change=\"handleFileUpload\" accept=\".csv, .xlsx, .xls\" style=\"display: none;\" />\r\n        \r\n        <button @click=\"exportToPDF\" class=\"export-btn\">\r\n          <i class=\"fas fa-file-export\"></i> Export PDF\r\n        </button>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"filters\">\r\n      <input\r\n        type=\"text\"\r\n        v-model=\"searchQuery\"\r\n        placeholder=\"Search by Full Name...\"\r\n        class=\"search-input\"\r\n      />\r\n\r\n      <select v-model=\"statusFilter\" class=\"status-filter\">\r\n        <option value=\"\">All Statuses</option>\r\n        <option value=\"headman\">Headman</option>\r\n        <option value=\"assistant\">Assistant</option>\r\n        <option value=\"villager\">Villager</option>\r\n        <option value=\"pending\">Pending</option>\r\n      </select>\r\n    </div>\r\n    \r\n    <div class=\"table-container\">\r\n      <table class=\"users-table\">\r\n        <thead>\r\n          <tr>\r\n            <th @click=\"sortBy('user_id')\" class=\"sortable\">\r\n              ID <span v-if=\"sortKey === 'user_id'\" :class=\"sortOrder === 1 ? 'asc' : 'desc'\"></span>\r\n            </th>\r\n            <th @click=\"sortBy('fullName')\" class=\"sortable\">\r\n              Full Name <span v-if=\"sortKey === 'fullName'\" :class=\"sortOrder === 1 ? 'asc' : 'desc'\"></span>\r\n            </th>\r\n            <th @click=\"sortBy('phone')\" class=\"sortable\">\r\n              Phone <span v-if=\"sortKey === 'phone'\" :class=\"sortOrder === 1 ? 'asc' : 'desc'\"></span>\r\n            </th>\r\n            <th @click=\"sortBy('status')\" class=\"sortable\">\r\n              Status <span v-if=\"sortKey === 'status'\" :class=\"sortOrder === 1 ? 'asc' : 'desc'\"></span>\r\n            </th>\r\n            <th>Approved By</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-if=\"loading\" class=\"loading-row\">\r\n            <td colspan=\"6\">Loading users...</td>\r\n          </tr>\r\n          <tr v-else-if=\"filteredUsers.length === 0\" class=\"empty-row\">\r\n            <td colspan=\"6\">No users found</td>\r\n          </tr>\r\n          <tr v-for=\"user in filteredUsers\" :key=\"user.user_id\">\r\n            <td>{{ user.user_id }}</td>\r\n            <td>{{ user.first_name }} {{ user.last_name }}</td>\r\n            <td>{{ user.phone || 'N/A' }}</td>\r\n            <td>\r\n              <span class=\"status-badge\" :class=\"getStatusClass(user.status)\">\r\n                {{ formatStatus(user.status) }}\r\n              </span>\r\n            </td>\r\n            <td>\r\n              <span v-if=\"user.approved_by\">\r\n                {{ getApproverName(user.approved_by) }}\r\n                <br>\r\n                <small>{{ formatDate(user.approval_date) }}</small>\r\n              </span>\r\n              <span v-else>Not approved yet</span>\r\n            </td>\r\n            <td class=\"actions\">\r\n              <button @click=\"viewUser(user)\" class=\"btn btn-info\">View</button>\r\n              <button @click=\"editUser(user)\" class=\"btn btn-primary\">Edit</button>\r\n              <button \r\n                v-if=\"isHeadmanOrAssistant\" \r\n                @click=\"confirmDelete(user)\" \r\n                class=\"btn btn-danger\"\r\n              >\r\n                Delete\r\n              </button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n    \r\n    <!-- User Details Modal -->\r\n    <div v-if=\"selectedUser\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close\" @click=\"selectedUser = null\">&times;</span>\r\n        <h2>User Details</h2>\r\n        <div class=\"user-details\">\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">ID:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.user_id }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Email:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.user_email }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Name:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.first_name }} {{ selectedUser.last_name }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Phone:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.phone || 'N/A' }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Address:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.address || 'N/A' }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Status:</div>\r\n            <div class=\"detail-value\">\r\n              <span class=\"status-badge\" :class=\"getStatusClass(selectedUser.status)\">\r\n                {{ formatStatus(selectedUser.status) }}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Approved:</div>\r\n            <div class=\"detail-value\">{{ selectedUser.is_approved ? 'Yes' : 'No' }}</div>\r\n          </div>\r\n          <div class=\"detail-row\" v-if=\"selectedUser.approved_by\">\r\n            <div class=\"detail-label\">Approved By:</div>\r\n            <div class=\"detail-value\">{{ getApproverName(selectedUser.approved_by) }}</div>\r\n          </div>\r\n          <div class=\"detail-row\" v-if=\"selectedUser.approval_date\">\r\n            <div class=\"detail-label\">Approval Date:</div>\r\n            <div class=\"detail-value\">{{ formatDate(selectedUser.approval_date) }}</div>\r\n          </div>\r\n          <div class=\"detail-row\">\r\n            <div class=\"detail-label\">Created:</div>\r\n            <div class=\"detail-value\">{{ formatDate(selectedUser.created_at) }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Edit User Modal -->\r\n    <div v-if=\"editingUser\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close\" @click=\"cancelEdit\">&times;</span>\r\n        <h2>Edit User</h2>\r\n        <form @submit.prevent=\"saveUser\" class=\"edit-form\">\r\n          <div class=\"form-group\">\r\n            <label for=\"firstName\">First Name</label>\r\n            <input type=\"text\" id=\"firstName\" v-model=\"editingUser.first_name\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"lastName\">Last Name</label>\r\n            <input type=\"text\" id=\"lastName\" v-model=\"editingUser.last_name\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"email\">Email</label>\r\n            <input type=\"email\" id=\"email\" v-model=\"editingUser.user_email\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"phone\">Phone</label>\r\n            <input type=\"tel\" id=\"phone\" v-model=\"editingUser.phone\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"address\">Address</label>\r\n            <textarea id=\"address\" v-model=\"editingUser.address\"></textarea>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"status\">Status</label>\r\n            <select id=\"status\" v-model=\"editingUser.status\" required>\r\n              <option value=\"headman\">Headman</option>\r\n              <option value=\"assistant\">Assistant</option>\r\n              <option value=\"villager\">Villager</option>\r\n              <option value=\"pending\">Pending</option>\r\n            </select>\r\n          </div>\r\n          <div class=\"form-actions\">\r\n            <button type=\"button\" @click=\"cancelEdit\" class=\"btn btn-secondary\">Cancel</button>\r\n            <button type=\"submit\" class=\"btn btn-primary\">Save Changes</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- Delete Confirmation Modal -->\r\n    <div v-if=\"userToDelete\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close\" @click=\"userToDelete = null\">&times;</span>\r\n        <h2>Confirm Delete</h2>\r\n        <p>Are you sure you want to delete {{ userToDelete.first_name }} {{ userToDelete.last_name }}?</p>\r\n        <p class=\"warning\">This action cannot be undone.</p>\r\n        <div class=\"form-actions\">\r\n          <button @click=\"userToDelete = null\" class=\"btn btn-secondary\">Cancel</button>\r\n          <button @click=\"deleteUser\" class=\"btn btn-danger\">Delete</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/services/api';\r\n\r\nexport default {\r\n  name: 'AllUsersView',\r\n  data() {\r\n    return {\r\n      users: [],\r\n      approvers: {}, // Map of user IDs to names for approvers\r\n      loading: true,\r\n      error: null,\r\n      searchQuery: '',\r\n      statusFilter: '',\r\n      sortKey: 'user_id',\r\n      sortOrder: 1, // 1 for ascending, -1 for descending\r\n      selectedUser: null,\r\n      editingUser: null,\r\n      userToDelete: null,\r\n      currentUserStatus: localStorage.getItem('userStatus') || '',\r\n      isExporting: false\r\n    };\r\n  },\r\n  computed: {\r\n    isHeadmanOrAssistant() {\r\n      return this.currentUserStatus === 'headman' || this.currentUserStatus === 'assistant';\r\n    },\r\n    filteredUsers() {\r\n      let result = [...this.users];\r\n      \r\n      // Apply search filter - only by Full Name\r\n      if (this.searchQuery) {\r\n        const query = this.searchQuery.toLowerCase();\r\n        result = result.filter(user => {\r\n          const fullName = `${user.first_name} ${user.last_name}`.toLowerCase();\r\n          return fullName.includes(query);\r\n        });\r\n      }\r\n      \r\n      // Apply status filter\r\n      if (this.statusFilter) {\r\n        result = result.filter(user => user.status === this.statusFilter);\r\n      }\r\n      \r\n      // Apply sorting\r\n      result.sort((a, b) => {\r\n        let valueA, valueB;\r\n        \r\n        if (this.sortKey === 'fullName') {\r\n          valueA = `${a.first_name} ${a.last_name}`.toLowerCase();\r\n          valueB = `${b.first_name} ${b.last_name}`.toLowerCase();\r\n        } else {\r\n          valueA = a[this.sortKey];\r\n          valueB = b[this.sortKey];\r\n          \r\n          // Handle null or undefined values\r\n          if (valueA === null || valueA === undefined) valueA = '';\r\n          if (valueB === null || valueB === undefined) valueB = '';\r\n          \r\n          // Convert to lowercase if string\r\n          if (typeof valueA === 'string') valueA = valueA.toLowerCase();\r\n          if (typeof valueB === 'string') valueB = valueB.toLowerCase();\r\n        }\r\n        \r\n        if (valueA < valueB) return -1 * this.sortOrder;\r\n        if (valueA > valueB) return 1 * this.sortOrder;\r\n        return 0;\r\n      });\r\n      \r\n      return result;\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchUsers() {\r\n      this.loading = true;\r\n      try {\r\n        const response = await api.getAllUsers();\r\n        this.users = response.data.users;\r\n        \r\n        // Extract unique approver IDs\r\n        const approverIds = [...new Set(\r\n          this.users\r\n            .filter(user => user.approved_by)\r\n            .map(user => user.approved_by)\r\n        )];\r\n        \r\n        // Fetch approver names\r\n        for (const approverId of approverIds) {\r\n          try {\r\n            const response = await api.getUserById(approverId);\r\n            const approver = response.data;\r\n            this.approvers[approverId] = `${approver.first_name} ${approver.last_name}`;\r\n          } catch (error) {\r\n            console.error(`Error fetching approver ${approverId}:`, error);\r\n            this.approvers[approverId] = `User #${approverId}`;\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching users:', error);\r\n        this.error = 'Failed to load users. Please try again.';\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    sortBy(key) {\r\n      if (this.sortKey === key) {\r\n        // If already sorting by this key, reverse the order\r\n        this.sortOrder = -this.sortOrder;\r\n      } else {\r\n        // Otherwise, sort by the new key in ascending order\r\n        this.sortKey = key;\r\n        this.sortOrder = 1;\r\n      }\r\n    },\r\n    formatStatus(status) {\r\n      if (!status) return 'Unknown';\r\n      \r\n      // Capitalize first letter\r\n      return status.charAt(0).toUpperCase() + status.slice(1);\r\n    },\r\n    getStatusClass(status) {\r\n      if (!status) return 'status-unknown';\r\n      \r\n      switch(status.toLowerCase()) {\r\n        case 'headman': return 'status-headman';\r\n        case 'assistant': return 'status-assistant';\r\n        case 'villager': return 'status-villager';\r\n        case 'pending': return 'status-pending';\r\n        default: return 'status-unknown';\r\n      }\r\n    },\r\n    formatDate(dateString) {\r\n      if (!dateString) return 'N/A';\r\n      \r\n      const date = new Date(dateString);\r\n      return date.toLocaleString();\r\n    },\r\n    getApproverName(approverId) {\r\n      return this.approvers[approverId] || `User #${approverId}`;\r\n    },\r\n    viewUser(user) {\r\n      this.selectedUser = { ...user };\r\n    },\r\n    editUser(user) {\r\n      this.editingUser = { ...user };\r\n    },\r\n    cancelEdit() {\r\n      this.editingUser = null;\r\n    },\r\n    async saveUser() {\r\n      try {\r\n        await api.updateUser(this.editingUser.user_id, {\r\n          firstName: this.editingUser.first_name,\r\n          lastName: this.editingUser.last_name,\r\n          email: this.editingUser.user_email,\r\n          phone: this.editingUser.phone,\r\n          address: this.editingUser.address,\r\n          status: this.editingUser.status\r\n        });\r\n        \r\n        // Update the user in the local array\r\n        const index = this.users.findIndex(u => u.user_id === this.editingUser.user_id);\r\n        if (index !== -1) {\r\n          this.users[index] = { ...this.editingUser };\r\n        }\r\n        \r\n        this.editingUser = null;\r\n      } catch (error) {\r\n        console.error('Error updating user:', error);\r\n        alert('Failed to update user. Please try again.');\r\n      }\r\n    },\r\n    confirmDelete(user) {\r\n      this.userToDelete = { ...user };\r\n    },\r\n    async deleteUser() {\r\n      try {\r\n        await api.deleteUser(this.userToDelete.user_id);\r\n        \r\n        // Remove the user from the local array\r\n        this.users = this.users.filter(u => u.user_id !== this.userToDelete.user_id);\r\n        \r\n        this.userToDelete = null;\r\n        alert('User deleted successfully');\r\n      } catch (error) {\r\n        console.error('Error deleting user:', error);\r\n        alert('Failed to delete user. Please try again.');\r\n      }\r\n    },\r\n    \r\n    handleFileUpload(event) {\r\n      const file = event.target.files[0];\r\n      if (!file) return;\r\n      \r\n      // Check if user has permission to import\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการนำเข้าไฟล์ กรุณาติดต่อผู้ดูแลระบบ');\r\n        return;\r\n      }\r\n\r\n      // Check file type\r\n      const fileType = file.name.split('.').pop().toLowerCase();\r\n      if (!['csv', 'xlsx', 'xls'].includes(fileType)) {\r\n        alert('กรุณาอัปโหลดไฟล์ CSV หรือ Excel เท่านั้น');\r\n        return;\r\n      }\r\n\r\n      // Here you would normally process the file\r\n      // For now, we'll just show a success message\r\n      alert(`ไฟล์ ${file.name} ถูกอัปโหลดเรียบร้อยแล้ว (การประมวลผลจะถูกพัฒนาในเวอร์ชันถัดไป)`);\r\n\r\n      // Reset the file input\r\n      event.target.value = '';\r\n    },\r\n    \r\n    exportToPDF() {\r\n      if (this.isExporting) return;\r\n      \r\n      // Check if user has permission to export\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการส่งออกไฟล์ กรุณาติดต่อผู้ดูแลระบบ');\r\n        return;\r\n      }\r\n      \r\n      this.isExporting = true;\r\n\r\n      try {\r\n        // Prepare data for PDF\r\n        const title = 'รายชื่อพนักงานทั้งหมด';\r\n        const headers = ['รหัส', 'ชื่อ-นามสกุล', 'เบอร์โทรศัพท์', 'สถานะ', 'อนุมัติโดย'];\r\n        const data = this.filteredUsers.map(user => [\r\n          user.user_id,\r\n          `${user.first_name} ${user.last_name}`,\r\n          user.phone || 'ไม่ระบุ',\r\n          this.formatStatus(user.status),\r\n          user.approved_by ? this.getApproverName(user.approved_by) : 'ยังไม่ได้รับการอนุมัติ'\r\n        ]);\r\n\r\n        // Here you would normally generate the PDF\r\n        // For now, we'll just show a success message\r\n        alert(`กำลังส่งออกข้อมูลผู้ใช้ ${data.length} คน เป็นไฟล์ PDF (ฟังก์ชันนี้จะถูกพัฒนาในเวอร์ชันถัดไป)`);\r\n      } catch (error) {\r\n        console.error('Error exporting to PDF:', error);\r\n        alert('ไม่สามารถส่งออกไฟล์ PDF ได้ กรุณาลองอีกครั้ง');\r\n      } finally {\r\n        this.isExporting = false;\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    // Check if user is logged in\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      // Redirect to login page if not logged in\r\n      window.location.href = '/login';\r\n      return;\r\n    }\r\n    \r\n    this.fetchUsers();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.all-users-view {\r\n  width: 100%;\r\n  padding: 20px;\r\n}\r\n\r\n.header-container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\nh1 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.user-count {\r\n  font-size: 0.6em;\r\n  color: #666;\r\n  margin-left: 10px;\r\n  font-weight: normal;\r\n}\r\n\r\n.action-section {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n\r\n.import-btn {\r\n  display: inline-block;\r\n  background-color: #28a745;\r\n  color: white;\r\n  padding: 8px 15px;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.import-btn:hover {\r\n  background-color: #218838;\r\n}\r\n\r\n.export-btn {\r\n  display: inline-block;\r\n  background-color: #007bff;\r\n  color: white;\r\n  padding: 8px 15px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.export-btn:hover {\r\n  background-color: #0069d9;\r\n}\r\n\r\n.filters {\r\n  display: flex;\r\n  margin-bottom: 20px;\r\n  gap: 10px;\r\n}\r\n\r\n.search-input {\r\n  flex: 1;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n}\r\n\r\n.status-filter {\r\n  padding: 8px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  min-width: 150px;\r\n}\r\n\r\n.table-container {\r\n  overflow-x: auto;\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.users-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.users-table th, .users-table td {\r\n  padding: 12px 15px;\r\n  text-align: left;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.users-table th {\r\n  background-color: #f8f9fa;\r\n  font-weight: bold;\r\n  color: #495057;\r\n}\r\n\r\n.users-table tr:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.sortable {\r\n  cursor: pointer;\r\n  position: relative;\r\n}\r\n\r\n.sortable:hover {\r\n  background-color: #e9ecef;\r\n}\r\n\r\n.asc::after {\r\n  content: \" ▲\";\r\n  font-size: 0.8em;\r\n}\r\n\r\n.desc::after {\r\n  content: \" ▼\";\r\n  font-size: 0.8em;\r\n}\r\n\r\n.loading-row td, .empty-row td {\r\n  text-align: center;\r\n  padding: 30px;\r\n  color: #6c757d;\r\n}\r\n\r\n.status-badge {\r\n  display: inline-block;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  font-size: 0.85em;\r\n  font-weight: bold;\r\n}\r\n\r\n.status-headman {\r\n  background-color: #cce5ff;\r\n  color: #004085;\r\n}\r\n\r\n.status-assistant {\r\n  background-color: #d4edda;\r\n  color: #155724;\r\n}\r\n\r\n.status-villager {\r\n  background-color: #fff3cd;\r\n  color: #856404;\r\n}\r\n\r\n.status-pending {\r\n  background-color: #f8d7da;\r\n  color: #721c24;\r\n}\r\n\r\n.status-unknown {\r\n  background-color: #e2e3e5;\r\n  color: #383d41;\r\n}\r\n\r\n.actions {\r\n  display: flex;\r\n  gap: 5px;\r\n}\r\n\r\n.btn {\r\n  display: inline-block;\r\n  font-weight: 400;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: middle;\r\n  user-select: none;\r\n  border: 1px solid transparent;\r\n  padding: 0.375rem 0.75rem;\r\n  font-size: 0.9rem;\r\n  line-height: 1.5;\r\n  border-radius: 0.25rem;\r\n  transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;\r\n  cursor: pointer;\r\n}\r\n\r\n.btn-primary {\r\n  color: #fff;\r\n  background-color: #007bff;\r\n  border-color: #007bff;\r\n}\r\n\r\n.btn-primary:hover {\r\n  background-color: #0069d9;\r\n  border-color: #0062cc;\r\n}\r\n\r\n.btn-info {\r\n  color: #fff;\r\n  background-color: #17a2b8;\r\n  border-color: #17a2b8;\r\n}\r\n\r\n.btn-info:hover {\r\n  background-color: #138496;\r\n  border-color: #117a8b;\r\n}\r\n\r\n.btn-danger {\r\n  color: #fff;\r\n  background-color: #dc3545;\r\n  border-color: #dc3545;\r\n}\r\n\r\n.btn-danger:hover {\r\n  background-color: #c82333;\r\n  border-color: #bd2130;\r\n}\r\n\r\n.btn-secondary {\r\n  color: #fff;\r\n  background-color: #6c757d;\r\n  border-color: #6c757d;\r\n}\r\n\r\n.btn-secondary:hover {\r\n  background-color: #5a6268;\r\n  border-color: #545b62;\r\n}\r\n\r\n/* Modal styles */\r\n.modal {\r\n  position: fixed;\r\n  z-index: 1050;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: auto;\r\n  background-color: rgba(0, 0, 0, 0.4);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.modal-content {\r\n  background-color: #fefefe;\r\n  margin: auto;\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\r\n  width: 80%;\r\n  max-width: 600px;\r\n  position: relative;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.close {\r\n  position: absolute;\r\n  right: 15px;\r\n  top: 10px;\r\n  color: #aaa;\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n}\r\n\r\n.close:hover {\r\n  color: #333;\r\n}\r\n\r\n.user-details {\r\n  margin-top: 20px;\r\n}\r\n\r\n.detail-row {\r\n  display: flex;\r\n  margin-bottom: 10px;\r\n  padding-bottom: 10px;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.detail-row:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.detail-label {\r\n  font-weight: bold;\r\n  width: 120px;\r\n  color: #495057;\r\n}\r\n\r\n.detail-value {\r\n  flex: 1;\r\n}\r\n\r\n.edit-form {\r\n  margin-top: 20px;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: bold;\r\n  color: #495057;\r\n}\r\n\r\n.form-group input,\r\n.form-group select,\r\n.form-group textarea {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 1rem;\r\n}\r\n\r\n.form-group textarea {\r\n  min-height: 100px;\r\n  resize: vertical;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.warning {\r\n  color: #dc3545;\r\n  font-weight: bold;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .actions {\r\n    flex-direction: column;\r\n    gap: 5px;\r\n  }\r\n  \r\n  .btn {\r\n    width: 100%;\r\n  }\r\n  \r\n  .modal-content {\r\n    width: 95%;\r\n    padding: 15px;\r\n  }\r\n  \r\n  .detail-row {\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .detail-label {\r\n    width: 100%;\r\n    margin-bottom: 5px;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}