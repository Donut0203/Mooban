{"ast":null,"code":"import axios from 'axios';\n\n// Create axios instance with base URL\nconst apiClient = axios.create({\n  baseURL: '/api',\n  // ใช้ URL แบบสัมพัทธ์เพื่อให้ทำงานได้กับ proxy ของ Vue\n  headers: {\n    'Content-Type': 'application/json',\n    'Cache-Control': 'no-cache'\n  },\n  timeout: 15000 // Increased timeout to 15 seconds\n});\n\n// Log the base URL for debugging\nconsole.log('API Client Base URL:', apiClient.defaults.baseURL);\n\n// Add a request interceptor\napiClient.interceptors.request.use(config => {\n  console.log(`API Request: ${config.method.toUpperCase()} ${config.url}`);\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  console.error('API Request Error:', error);\n  return Promise.reject(error);\n});\n\n// Add a response interceptor for better error logging\napiClient.interceptors.response.use(response => {\n  console.log(`API Response: ${response.status} from ${response.config.url}`);\n  return response;\n}, error => {\n  if (error.response) {\n    // The request was made and the server responded with a status code\n    // that falls out of the range of 2xx\n    console.error('API Error Response:', {\n      status: error.response.status,\n      url: error.config.url,\n      data: error.response.data\n    });\n  } else if (error.request) {\n    // The request was made but no response was received\n    console.error('API No Response Error:', {\n      url: error.config.url,\n      request: error.request\n    });\n  } else {\n    // Something happened in setting up the request that triggered an Error\n    console.error('API Setup Error:', error.message);\n  }\n  return Promise.reject(error);\n});\nconst api = {\n  // Auth endpoints\n  login(credentials) {\n    console.log('Login attempt with:', {\n      email: credentials.email,\n      passwordLength: credentials.password?.length || 0\n    });\n    return apiClient.post('/auth/login', credentials).catch(error => {\n      // Add specific error handling for login\n      if (!error.response) {\n        console.error('Login failed: No response from server. Check if backend is running at http://localhost:4000');\n      }\n      throw error;\n    });\n  },\n  register(userData) {\n    return apiClient.post('/auth/register', userData);\n  },\n  // User management endpoints\n  getPendingUsers() {\n    return apiClient.get('/auth/pending-users');\n  },\n  approveUser(userId) {\n    return apiClient.put(`/auth/approve/${userId}`);\n  },\n  // User profile\n  getUserProfile() {\n    return apiClient.get('/auth/profile');\n  },\n  updateUserProfile(userData) {\n    return apiClient.put('/auth/profile', userData);\n  },\n  // Upload profile picture - ต้องระบุ userId เพื่อให้ตรงกับ route ที่กำหนดไว้\n  uploadProfilePicture(imageData) {\n    // ดึง userId จาก localStorage\n    const userId = localStorage.getItem('userId');\n    if (!userId) {\n      return Promise.reject(new Error('ไม่พบข้อมูลผู้ใช้ กรุณาเข้าสู่ระบบใหม่อีกครั้ง'));\n    }\n    return apiClient.post(`/auth/upload-profile-picture/${userId}`, {\n      imageData\n    }, {\n      headers: {\n        'Content-Type': 'application/json',\n        'Cache-Control': 'no-cache, no-store'\n      }\n    });\n  },\n  // Get all users\n  getAllUsers() {\n    return apiClient.get('/auth/users');\n  },\n  // Get user by ID\n  getUserById(userId) {\n    return apiClient.get(`/auth/users/${userId}`);\n  },\n  // Update user\n  updateUser(userId, userData) {\n    return apiClient.put(`/auth/users/${userId}`, userData);\n  },\n  // Delete user\n  deleteUser(userId) {\n    return apiClient.delete(`/auth/users/${userId}`);\n  },\n  // Get pending users count\n  getPendingUsersCount() {\n    return apiClient.get('/auth/pending-users-count');\n  },\n  // Get dashboard data\n  getDashboardData() {\n    return apiClient.get('/auth/dashboard');\n  }\n};\nexport default api;","map":{"version":3,"names":["axios","apiClient","create","baseURL","headers","timeout","console","log","defaults","interceptors","request","use","config","method","toUpperCase","url","token","localStorage","getItem","Authorization","error","Promise","reject","response","status","data","message","api","login","credentials","email","passwordLength","password","length","post","catch","register","userData","getPendingUsers","get","approveUser","userId","put","getUserProfile","updateUserProfile","uploadProfilePicture","imageData","Error","getAllUsers","getUserById","updateUser","deleteUser","delete","getPendingUsersCount","getDashboardData"],"sources":["C:/Users/HP/Documents/mooban4/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n// Create axios instance with base URL\r\nconst apiClient = axios.create({\r\n  baseURL: '/api',  // ใช้ URL แบบสัมพัทธ์เพื่อให้ทำงานได้กับ proxy ของ Vue\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n    'Cache-Control': 'no-cache'\r\n  },\r\n  timeout: 15000 // Increased timeout to 15 seconds\r\n});\r\n\r\n// Log the base URL for debugging\r\nconsole.log('API Client Base URL:', apiClient.defaults.baseURL);\r\n\r\n// Add a request interceptor\r\napiClient.interceptors.request.use(\r\n  config => {\r\n    console.log(`API Request: ${config.method.toUpperCase()} ${config.url}`);\r\n    const token = localStorage.getItem('token');\r\n    if (token) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  error => {\r\n    console.error('API Request Error:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add a response interceptor for better error logging\r\napiClient.interceptors.response.use(\r\n  response => {\r\n    console.log(`API Response: ${response.status} from ${response.config.url}`);\r\n    return response;\r\n  },\r\n  error => {\r\n    if (error.response) {\r\n      // The request was made and the server responded with a status code\r\n      // that falls out of the range of 2xx\r\n      console.error('API Error Response:', {\r\n        status: error.response.status,\r\n        url: error.config.url,\r\n        data: error.response.data\r\n      });\r\n    } else if (error.request) {\r\n      // The request was made but no response was received\r\n      console.error('API No Response Error:', {\r\n        url: error.config.url,\r\n        request: error.request\r\n      });\r\n    } else {\r\n      // Something happened in setting up the request that triggered an Error\r\n      console.error('API Setup Error:', error.message);\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nconst api = {\r\n  // Auth endpoints\r\n  login(credentials) {\r\n    console.log('Login attempt with:', { email: credentials.email, passwordLength: credentials.password?.length || 0 });\r\n    return apiClient.post('/auth/login', credentials)\r\n      .catch(error => {\r\n        // Add specific error handling for login\r\n        if (!error.response) {\r\n          console.error('Login failed: No response from server. Check if backend is running at http://localhost:4000');\r\n        }\r\n        throw error;\r\n      });\r\n  },\r\n  register(userData) {\r\n    return apiClient.post('/auth/register', userData);\r\n  },\r\n  // User management endpoints\r\n  getPendingUsers() {\r\n    return apiClient.get('/auth/pending-users');\r\n  },\r\n  approveUser(userId) {\r\n    return apiClient.put(`/auth/approve/${userId}`);\r\n  },\r\n  // User profile\r\n  getUserProfile() {\r\n    return apiClient.get('/auth/profile');\r\n  },\r\n  updateUserProfile(userData) {\r\n    return apiClient.put('/auth/profile', userData);\r\n  },\r\n  // Upload profile picture - ต้องระบุ userId เพื่อให้ตรงกับ route ที่กำหนดไว้\r\n  uploadProfilePicture(imageData) {\r\n    // ดึง userId จาก localStorage\r\n    const userId = localStorage.getItem('userId');\r\n    if (!userId) {\r\n      return Promise.reject(new Error('ไม่พบข้อมูลผู้ใช้ กรุณาเข้าสู่ระบบใหม่อีกครั้ง'));\r\n    }\r\n\r\n    return apiClient.post(`/auth/upload-profile-picture/${userId}`, { imageData }, {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Cache-Control': 'no-cache, no-store'\r\n      }\r\n    });\r\n  },\r\n  // Get all users\r\n  getAllUsers() {\r\n    return apiClient.get('/auth/users');\r\n  },\r\n  // Get user by ID\r\n  getUserById(userId) {\r\n    return apiClient.get(`/auth/users/${userId}`);\r\n  },\r\n  // Update user\r\n  updateUser(userId, userData) {\r\n    return apiClient.put(`/auth/users/${userId}`, userData);\r\n  },\r\n  // Delete user\r\n  deleteUser(userId) {\r\n    return apiClient.delete(`/auth/users/${userId}`);\r\n  },\r\n  // Get pending users count\r\n  getPendingUsersCount() {\r\n    return apiClient.get('/auth/pending-users-count');\r\n  },\r\n  // Get dashboard data\r\n  getDashboardData() {\r\n    return apiClient.get('/auth/dashboard');\r\n  }\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}