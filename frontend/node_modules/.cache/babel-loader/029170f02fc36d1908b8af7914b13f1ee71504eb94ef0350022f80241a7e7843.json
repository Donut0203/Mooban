{"ast":null,"code":"import api from '@/services/api';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nexport default {\n  name: 'MemberManagement',\n  data() {\n    return {\n      members: [],\n      formData: {\n        first_name: '',\n        last_name: '',\n        phone: '',\n        bank_name: '',\n        bank_account: '',\n        national_id: '',\n        address_line1: '',\n        subdistrict: '',\n        district: '',\n        province: '',\n        postal_code: '',\n        id_card_copy: '',\n        house_registration_copy: '',\n        birth_date: \"\",\n        balance: 0\n      },\n      showAddForm: false,\n      showViewModal: false,\n      showDeleteModal: false,\n      isEditing: false,\n      selectedMember: {},\n      searchQuery: ''\n    };\n  },\n  computed: {\n    filteredMembers() {\n      if (!this.searchQuery) {\n        return this.members;\n      }\n      const query = this.searchQuery.toLowerCase();\n      return this.members.filter(member => {\n        return member.member_id.toString().includes(query) || member.first_name.toLowerCase().includes(query) || member.last_name.toLowerCase().includes(query) || member.phone.includes(query) || member.national_id.includes(query);\n      });\n    }\n  },\n  methods: {\n    // โหลดข้อมูลสมาชิกทั้งหมด\n    async loadMembers() {\n      try {\n        const response = await api.getMembers();\n        this.members = response.data;\n      } catch (error) {\n        console.error('Error loading members:', error);\n        alert('ไม่สามารถโหลดข้อมูลสมาชิกได้');\n      }\n    },\n    // จัดการการอัพโหลดรูปภาพ\n    handleIdCardUpload(event) {\n      const file = event.target.files[0];\n      if (file) {\n        this.uploadFile(file, 'id_card_copy');\n      }\n    },\n    handleHouseRegUpload(event) {\n      const file = event.target.files[0];\n      if (file) {\n        this.uploadFile(file, 'house_registration_copy');\n      }\n    },\n    // อัพโหลดไฟล์\n    async uploadFile(file, fieldName) {\n      const formData = new FormData();\n      formData.append('file', file);\n      try {\n        const response = await api.uploadFile(formData);\n        this.formData[fieldName] = response.data.fileUrl;\n      } catch (error) {\n        console.error('Error uploading file:', error);\n        alert('ไม่สามารถอัพโหลดไฟล์ได้');\n      }\n    },\n    // ส่งฟอร์ม\n    async submitForm() {\n      try {\n        if (this.isEditing) {\n          // แก้ไขข้อมูลสมาชิก\n          await api.updateMember(this.formData.member_id, this.formData);\n          alert('แก้ไขข้อมูลสมาชิกเรียบร้อยแล้ว');\n        } else {\n          // เพิ่มสมาชิกใหม่\n          await api.createMember(this.formData);\n          alert('เพิ่มสมาชิกใหม่เรียบร้อยแล้ว');\n        }\n        this.closeForm();\n        this.loadMembers();\n      } catch (error) {\n        console.error('Error submitting form:', error);\n        alert('ไม่สามารถบันทึกข้อมูลได้');\n      }\n    },\n    // ดูรายละเอียดสมาชิก\n    viewMember(member) {\n      this.selectedMember = {\n        ...member\n      };\n      this.showViewModal = true;\n    },\n    // แก้ไขข้อมูลสมาชิก\n    editMember(member) {\n      this.isEditing = true;\n      this.formData = {\n        ...member\n      };\n      this.showAddForm = true;\n    },\n    // ยืนยันการลบ\n    confirmDelete(member) {\n      this.selectedMember = member;\n      this.showDeleteModal = true;\n    },\n    // ลบสมาชิก\n    async deleteMember() {\n      try {\n        await api.deleteMember(this.selectedMember.member_id);\n        alert('ลบข้อมูลสมาชิกเรียบร้อยแล้ว');\n        this.showDeleteModal = false;\n        this.loadMembers();\n      } catch (error) {\n        console.error('Error deleting member:', error);\n        alert('ไม่สามารถลบข้อมูลสมาชิกได้');\n      }\n    },\n    // ปิดฟอร์ม\n    closeForm() {\n      this.showAddForm = false;\n      this.isEditing = false;\n      this.formData = {\n        first_name: '',\n        last_name: '',\n        phone: '',\n        bank_name: '',\n        bank_account: '',\n        national_id: '',\n        address_line1: '',\n        subdistrict: '',\n        district: '',\n        province: '',\n        postal_code: '',\n        id_card_copy: '',\n        house_registration_copy: '',\n        birth_date: \"\",\n        balance: 0\n      };\n    },\n    // จัดรูปแบบที่อยู่\n    formatAddress(member) {\n      let address = member.address_line1 || '';\n      if (member.subdistrict) {\n        address += ` ต.${member.subdistrict}`;\n      }\n      if (member.district) {\n        address += ` อ.${member.district}`;\n      }\n      if (member.province) {\n        address += ` จ.${member.province}`;\n      }\n      if (member.postal_code) {\n        address += ` ${member.postal_code}`;\n      }\n      return address;\n    },\n    // จัดรูปแบบวันที่\n    formatDate(dateString) {\n      if (!dateString) return '-';\n      const date = new Date(dateString);\n      return new Intl.DateTimeFormat('th-TH', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      }).format(date);\n    },\n    // จัดรูปแบบเงิน\n    formatCurrency(amount) {\n      return new Intl.NumberFormat('th-TH', {\n        style: 'currency',\n        currency: 'THB'\n      }).format(amount || 0);\n    },\n    // พิมพ์ PDF\n    async printPDF() {\n      const doc = new jsPDF(\"p\", \"mm\", \"a4\");\n\n      // กำหนดเส้นทางไฟล์ฟอนต์ที่ถูกต้องจาก public\n      const fontUrl = '/THSarabunNew.ttf'; // เส้นทางที่เข้าถึงไฟล์จาก public\n\n      // ฟอนต์ที่คุณต้องการใช้ใน jsPDF\n      const fontName = \"THSarabun\";\n\n      // เพิ่มฟอนต์จาก public (ใช้ addFileToVFS เพื่อให้ jsPDF รับรู้ฟอนต์)\n      await doc.addFileToVFS(fontName, fontUrl);\n      doc.addFont(fontUrl, fontName, \"normal\"); // เพิ่มฟอนต์ให้กับ jsPDF\n      doc.setFont(fontName); // กำหนดฟอนต์ที่ต้องการใช้\n\n      // เพิ่มเนื้อหาลงใน PDF\n      doc.setFontSize(18);\n      doc.text(\"รายละเอียดสมาชิก\", 15, 20);\n\n      // เริ่มข้อมูลสมาชิก\n      doc.setFontSize(12);\n      let y = 30;\n      const addText = (label, value) => {\n        //  doc.setFont(\"THSarabun\", \"bold\");\n        doc.text(`${label}: `, 15, y);\n        // doc.setFont(\"THSarabun\", \"normal\");\n        doc.text(value ? value.toString() : \"-\", 55, y);\n        y += 8;\n      };\n      addText(\"รหัสสมาชิก\", this.selectedMember.member_id);\n      addText(\"ชื่อ-นามสกุล\", `${this.selectedMember.first_name} ${this.selectedMember.last_name}`);\n      addText(\"เบอร์โทรศัพท์\", this.selectedMember.phone);\n      addText(\"ธนาคาร\", this.selectedMember.bank_name);\n      addText(\"เลขบัญชี\", this.selectedMember.bank_account);\n      addText(\"เลขบัตรประชาชน\", this.selectedMember.national_id);\n      addText(\"ที่อยู่\", this.formatAddress(this.selectedMember));\n      addText(\"ยอดคงเหลือ\", this.formatCurrency(this.selectedMember.balance));\n      addText(\"ผู้สร้างข้อมูล\", this.selectedMember.created_by);\n      addText(\"วันที่สร้างข้อมูล\", this.formatDate(this.selectedMember.created_at));\n      addText(\"ผู้แก้ไขล่าสุด\", this.selectedMember.updated_by);\n      addText(\"วันที่แก้ไขล่าสุด\", this.formatDate(this.selectedMember.updated_at));\n\n      // เพิ่มรูปภาพ (สำเนาบัตรประชาชน & ทะเบียนบ้าน)\n      const addImage = async (imgSrc, label) => {\n        if (imgSrc) {\n          try {\n            const img = await this.loadImage(imgSrc);\n            doc.setFont(\"THSarabun\", \"bold\");\n            doc.text(label, 15, y + 5);\n            doc.addImage(img, \"JPEG\", 15, y + 10, 80, 50); // ใช้ Base64 ที่ได้\n            y += 65;\n          } catch (error) {\n            console.error(`โหลดรูป ${label} ไม่สำเร็จ`, error);\n          }\n        }\n      };\n      await addImage(this.selectedMember.id_card_copy, \"สำเนาบัตรประชาชน\");\n      await addImage(this.selectedMember.house_registration_copy, \"สำเนาทะเบียนบ้าน\");\n\n      // บันทึกไฟล์ PDF\n      doc.save(`Member_${this.selectedMember.member_id}.pdf`);\n    },\n    // โหลดรูปภาพ\n    loadImage(src) {\n      return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.crossOrigin = \"Anonymous\"; // รองรับการดึงภาพจากโดเมนต่าง ๆ\n        img.src = `http://localhost:8080/uploads/${src}`; // ปรับ URL ตามที่เซิร์ฟเวอร์สามารถเข้าถึงได้\n        img.onload = () => {\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = img.width;\n          canvas.height = img.height;\n          const ctx = canvas.getContext(\"2d\");\n          ctx.drawImage(img, 0, 0);\n\n          // ตรวจสอบชนิดของไฟล์ และแปลงเป็น Base64 ตามประเภทของไฟล์\n          const fileExtension = src.split('.').pop().toLowerCase();\n          let mimeType = \"image/jpg\"; // Default เป็น JPEG\n\n          if (fileExtension === \"png\") {\n            mimeType = \"image/png\"; // หากเป็น PNG ให้ใช้ image/png\n          }\n          const base64Image = canvas.toDataURL(mimeType);\n\n          // พิมพ์ Base64 ในคอนโซลเพื่อการตรวจสอบ\n          console.log(base64Image);\n          resolve(base64Image);\n        };\n        img.onerror = reject;\n      });\n    }\n  },\n  created() {\n    this.loadMembers();\n  }\n};","map":{"version":3,"names":["api","jsPDF","html2canvas","name","data","members","formData","first_name","last_name","phone","bank_name","bank_account","national_id","address_line1","subdistrict","district","province","postal_code","id_card_copy","house_registration_copy","birth_date","balance","showAddForm","showViewModal","showDeleteModal","isEditing","selectedMember","searchQuery","computed","filteredMembers","query","toLowerCase","filter","member","member_id","toString","includes","methods","loadMembers","response","getMembers","error","console","alert","handleIdCardUpload","event","file","target","files","uploadFile","handleHouseRegUpload","fieldName","FormData","append","fileUrl","submitForm","updateMember","createMember","closeForm","viewMember","editMember","confirmDelete","deleteMember","formatAddress","address","formatDate","dateString","date","Date","Intl","DateTimeFormat","year","month","day","hour","minute","format","formatCurrency","amount","NumberFormat","style","currency","printPDF","doc","fontUrl","fontName","addFileToVFS","addFont","setFont","setFontSize","text","y","addText","label","value","created_by","created_at","updated_by","updated_at","addImage","imgSrc","img","loadImage","save","src","Promise","resolve","reject","Image","crossOrigin","onload","canvas","document","createElement","width","height","ctx","getContext","drawImage","fileExtension","split","pop","mimeType","base64Image","toDataURL","log","onerror","created"],"sources":["C:\\Users\\HP\\Documents\\GitHub\\Mooban\\frontend\\src\\views\\Member.vue"],"sourcesContent":["<template>\r\n  <div class=\"member-container\">\r\n    <div class=\"header\">\r\n      <h1>จัดการข้อมูลสมาชิก</h1>\r\n      <button class=\"btn-add\" @click=\"showAddForm = true\">เพิ่มสมาชิกใหม่</button>\r\n    </div>\r\n\r\n    <!-- ฟอร์มเพิ่มสมาชิก -->\r\n    <div class=\"modal\" v-if=\"showAddForm\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h2>{{ isEditing ? 'แก้ไขข้อมูลสมาชิก' : 'เพิ่มสมาชิกใหม่' }}</h2>\r\n          <span class=\"close\" @click=\"closeForm\">&times;</span>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <form @submit.prevent=\"submitForm\">\r\n            <div class=\"form-group\">\r\n              <label for=\"first_name\">ชื่อจริง <span class=\"required\">*</span></label>\r\n              <input type=\"text\" id=\"first_name\" v-model=\"formData.first_name\" required>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"last_name\">นามสกุล <span class=\"required\">*</span></label>\r\n              <input type=\"text\" id=\"last_name\" v-model=\"formData.last_name\" required>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"phone\">เบอร์โทรศัพท์ <span class=\"required\">*</span></label>\r\n              <input type=\"text\" id=\"phone\" v-model=\"formData.phone\" required>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n               <label for=\"birth_date\">วันเกิด <span class=\"required\">*</span></label>\r\n                <input type=\"date\" id=\"birth_date\" v-model=\"formData.birth_date\" required>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label for=\"national_id\">หมายเลขบัตรประชาชน <span class=\"required\">*</span></label>\r\n              <input type=\"text\" id=\"national_id\" v-model=\"formData.national_id\" required>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"bank_name\">ชื่อธนาคาร <span class=\"required\">*</span></label>\r\n              <select id=\"bank_name\" v-model=\"formData.bank_name\" required>\r\n                <option value=\"\">เลือกธนาคาร</option>\r\n                <option value=\"กรุงเทพ\">ธนาคารกรุงเทพ</option>\r\n                <option value=\"กสิกรไทย\">ธนาคารกสิกรไทย</option>\r\n                <option value=\"กรุงไทย\">ธนาคารกรุงไทย</option>\r\n                <option value=\"ไทยพาณิชย์\">ธนาคารไทยพาณิชย์</option>\r\n                <option value=\"ออมสิน\">ธนาคารออมสิน</option>\r\n                <option value=\"ธกส\">ธนาคารเพื่อการเกษตรและสหกรณ์การเกษตร</option>\r\n                <option value=\"อื่นๆ\">อื่นๆ</option>\r\n              </select>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"bank_account\">หมายเลขบัญชีธนาคาร <span class=\"required\">*</span></label>\r\n              <input type=\"text\" id=\"bank_account\" v-model=\"formData.bank_account\" required>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"address_line1\">ที่อยู่ <span class=\"required\">*</span></label>\r\n              <textarea id=\"address_line1\" v-model=\"formData.address_line1\" required></textarea>\r\n            </div>\r\n            \r\n            <div class=\"form-row\">\r\n              <div class=\"form-group half\">\r\n                <label for=\"subdistrict\">ตำบล</label>\r\n                <input type=\"text\" id=\"subdistrict\" v-model=\"formData.subdistrict\">\r\n              </div>\r\n              \r\n              <div class=\"form-group half\">\r\n                <label for=\"district\">อำเภอ</label>\r\n                <input type=\"text\" id=\"district\" v-model=\"formData.district\">\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"form-row\">\r\n              <div class=\"form-group half\">\r\n                <label for=\"province\">จังหวัด</label>\r\n                <input type=\"text\" id=\"province\" v-model=\"formData.province\">\r\n              </div>\r\n              \r\n              <div class=\"form-group half\">\r\n                <label for=\"postal_code\">รหัสไปรษณีย์</label>\r\n                <input type=\"text\" id=\"postal_code\" v-model=\"formData.postal_code\">\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"id_card_copy\">สำเนาบัตรประชาชน <span class=\"required\">*</span></label>\r\n              <input type=\"file\" id=\"id_card_copy\" @change=\"handleIdCardUpload\">\r\n              <div class=\"preview\" v-if=\"formData.id_card_copy\">\r\n                <img :src=\"formData.id_card_copy\" alt=\"สำเนาบัตรประชาชน\">\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"form-group\">\r\n              <label for=\"house_registration_copy\">สำเนาทะเบียนบ้าน <span class=\"required\">*</span></label>\r\n              <input type=\"file\" id=\"house_registration_copy\" @change=\"handleHouseRegUpload\">\r\n              <div class=\"preview\" v-if=\"formData.house_registration_copy\">\r\n                <img :src=\"formData.house_registration_copy\" alt=\"สำเนาทะเบียนบ้าน\">\r\n              </div>\r\n            </div>\r\n            \r\n            <div class=\"form-group\" v-if=\"isEditing\">\r\n              <label for=\"balance\">ยอดคงเหลือ</label>\r\n              <input type=\"number\" id=\"balance\" v-model=\"formData.balance\" step=\"0.01\">\r\n            </div>\r\n            \r\n            <div class=\"form-actions\">\r\n              <button type=\"button\" class=\"btn-cancel\" @click=\"closeForm\">ยกเลิก</button>\r\n              <button type=\"submit\" class=\"btn-submit\">{{ isEditing ? 'บันทึกการแก้ไข' : 'เพิ่มสมาชิก' }}</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- ตารางแสดงข้อมูลสมาชิก -->\r\n    <div class=\"table-container\">\r\n      <div class=\"search-bar\">\r\n        <input type=\"text\" v-model=\"searchQuery\" placeholder=\"ค้นหาสมาชิก...\">\r\n      </div>\r\n      <table class=\"member-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>รหัสสมาชิก</th>\r\n            <th>ชื่อ-นามสกุล</th>\r\n            <th>เบอร์โทรศัพท์</th>\r\n            <th>อายุ</th>\r\n            <th>ธนาคาร</th>\r\n            <th>เลขบัญชี</th>\r\n            <th>เลขบัตรประชาชน</th>\r\n            <th>ที่อยู่</th>\r\n            <th>ยอดคงเหลือ</th>\r\n            <th>การจัดการ</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"member in filteredMembers\" :key=\"member.member_id\">\r\n            <td>{{ member.member_id }}</td>\r\n            <td>{{ member.first_name }} {{ member.last_name }}</td>\r\n            <td>{{ member.phone }}</td>\r\n            <td>{{ member.birth_date }}</td>\r\n            <td>{{ member.bank_name }}</td>\r\n            <td>{{ member.bank_account }}</td>\r\n            <td>{{ member.national_id }}</td>\r\n            <td>{{ formatAddress(member) }}</td>\r\n            <td>{{ formatCurrency(member.balance) }}</td>\r\n            <td class=\"actions\">\r\n              <button class=\"btn-view\" @click=\"viewMember(member)\">ดู</button>\r\n              <button class=\"btn-edit\" @click=\"editMember(member)\">แก้ไข</button>\r\n              <button class=\"btn-delete\" @click=\"confirmDelete(member)\">ลบ</button>\r\n            </td>\r\n          </tr>\r\n          <tr v-if=\"members.length === 0\">\r\n            <td colspan=\"9\" class=\"no-data\">ไม่พบข้อมูลสมาชิก</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <!-- Modal แสดงรายละเอียดสมาชิก -->\r\n<div class=\"modal\" v-if=\"showViewModal\">\r\n  <div class=\"modal-content\">\r\n    <div class=\"modal-header\">\r\n      <h2>รายละเอียดสมาชิก</h2>\r\n      <span class=\"close\" @click=\"showViewModal = false\">&times;</span>\r\n    </div>\r\n    <div class=\"modal-body member-details\">\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">รหัสสมาชิก:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.member_id }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ชื่อ-นามสกุล:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.first_name }} {{ selectedMember.last_name }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">เบอร์โทรศัพท์:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.phone }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">อายุ:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.birth_date }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ธนาคาร:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.bank_name }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">เลขบัญชี:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.bank_account }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">เลขบัตรประชาชน:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.national_id }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ที่อยู่:</div>\r\n        <div class=\"detail-value\">{{ formatAddress(selectedMember) }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ยอดคงเหลือ:</div>\r\n        <div class=\"detail-value\">{{ formatCurrency(selectedMember.balance) }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">สำเนาบัตรประชาชน:</div>\r\n        <div class=\"detail-value\">\r\n          <img :src=\"selectedMember.id_card_copy\" alt=\"สำเนาบัตรประชาชน\" class=\"document-preview\">\r\n        </div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">สำเนาทะเบียนบ้าน:</div>\r\n        <div class=\"detail-value\">\r\n          <img :src=\"selectedMember.house_registration_copy\" alt=\"สำเนาทะเบียนบ้าน\" class=\"document-preview\">\r\n        </div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ผู้สร้างข้อมูล:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.created_by }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">วันที่สร้างข้อมูล:</div>\r\n        <div class=\"detail-value\">{{ formatDate(selectedMember.created_at) }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">ผู้แก้ไขล่าสุด:</div>\r\n        <div class=\"detail-value\">{{ selectedMember.updated_by }}</div>\r\n      </div>\r\n      <div class=\"detail-row\">\r\n        <div class=\"detail-label\">วันที่แก้ไขล่าสุด:</div>\r\n        <div class=\"detail-value\">{{ formatDate(selectedMember.updated_at) }}</div>\r\n      </div>\r\n\r\n      <!-- ปุ่มปิด -->\r\n      <button class=\"btn-close\" @click=\"showViewModal = false\">ปิด</button>\r\n\r\n      <!-- ปุ่มปริ้น PDF -->\r\n      <button class=\"btn-print\" @click=\"printPDF\">พิมพ์ PDF</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n    <!-- Modal ยืนยันการลบ -->\r\n    <div class=\"modal\" v-if=\"showDeleteModal\">\r\n      <div class=\"modal-content delete-modal\">\r\n        <div class=\"modal-header\">\r\n          <h2>ยืนยันการลบ</h2>\r\n          <span class=\"close\" @click=\"showDeleteModal = false\">&times;</span>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <p>คุณต้องการลบข้อมูลสมาชิก {{ selectedMember.first_name }} {{ selectedMember.last_name }} ใช่หรือไม่?</p>\r\n          <div class=\"form-actions\">\r\n            <button class=\"btn-cancel\" @click=\"showDeleteModal = false\">ยกเลิก</button>\r\n            <button class=\"btn-delete\" @click=\"deleteMember\">ยืนยันการลบ</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/services/api';\r\nimport jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\n\r\nexport default {\r\n  name: 'MemberManagement',\r\n  data() {\r\n    return {\r\n      members: [],\r\n      formData: {\r\n        first_name: '',\r\n        last_name: '',\r\n        phone: '',\r\n        bank_name: '',\r\n        bank_account: '',\r\n        national_id: '',\r\n        address_line1: '',\r\n        subdistrict: '',\r\n        district: '',\r\n        province: '',\r\n        postal_code: '',\r\n        id_card_copy: '',\r\n        house_registration_copy: '',\r\n        birth_date: \"\",\r\n        balance: 0\r\n      },\r\n      showAddForm: false,\r\n      showViewModal: false,\r\n      showDeleteModal: false,\r\n      isEditing: false,\r\n      selectedMember: {},\r\n      searchQuery: ''\r\n    };\r\n  },\r\n  computed: {\r\n    filteredMembers() {\r\n      if (!this.searchQuery) {\r\n        return this.members;\r\n      }\r\n      const query = this.searchQuery.toLowerCase();\r\n      return this.members.filter(member => {\r\n        return member.member_id.toString().includes(query) ||\r\n          member.first_name.toLowerCase().includes(query) ||\r\n          member.last_name.toLowerCase().includes(query) ||\r\n          member.phone.includes(query) ||\r\n          member.national_id.includes(query);\r\n      });\r\n    }\r\n  },\r\n  methods: {\r\n    // โหลดข้อมูลสมาชิกทั้งหมด\r\n    async loadMembers() {\r\n      try {\r\n        const response = await api.getMembers();\r\n        this.members = response.data;\r\n      } catch (error) {\r\n        console.error('Error loading members:', error);\r\n        alert('ไม่สามารถโหลดข้อมูลสมาชิกได้');\r\n      }\r\n    },\r\n\r\n    // จัดการการอัพโหลดรูปภาพ\r\n    handleIdCardUpload(event) {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        this.uploadFile(file, 'id_card_copy');\r\n      }\r\n    },\r\n    handleHouseRegUpload(event) {\r\n      const file = event.target.files[0];\r\n      if (file) {\r\n        this.uploadFile(file, 'house_registration_copy');\r\n      }\r\n    },\r\n\r\n    // อัพโหลดไฟล์\r\n    async uploadFile(file, fieldName) {\r\n      const formData = new FormData();\r\n      formData.append('file', file);\r\n      try {\r\n        const response = await api.uploadFile(formData);\r\n        this.formData[fieldName] = response.data.fileUrl;\r\n      } catch (error) {\r\n        console.error('Error uploading file:', error);\r\n        alert('ไม่สามารถอัพโหลดไฟล์ได้');\r\n      }\r\n    },\r\n\r\n    // ส่งฟอร์ม\r\n    async submitForm() {\r\n      try {\r\n        if (this.isEditing) {\r\n          // แก้ไขข้อมูลสมาชิก\r\n          await api.updateMember(this.formData.member_id, this.formData);\r\n          alert('แก้ไขข้อมูลสมาชิกเรียบร้อยแล้ว');\r\n        } else {\r\n          // เพิ่มสมาชิกใหม่\r\n          await api.createMember(this.formData);\r\n          alert('เพิ่มสมาชิกใหม่เรียบร้อยแล้ว');\r\n        }\r\n        this.closeForm();\r\n        this.loadMembers();\r\n      } catch (error) {\r\n        console.error('Error submitting form:', error);\r\n        alert('ไม่สามารถบันทึกข้อมูลได้');\r\n      }\r\n    },\r\n\r\n    // ดูรายละเอียดสมาชิก\r\n    viewMember(member) {\r\n      this.selectedMember = { ...member };\r\n      this.showViewModal = true;\r\n    },\r\n\r\n    // แก้ไขข้อมูลสมาชิก\r\n    editMember(member) {\r\n      this.isEditing = true;\r\n      this.formData = { ...member };\r\n      this.showAddForm = true;\r\n    },\r\n\r\n    // ยืนยันการลบ\r\n    confirmDelete(member) {\r\n      this.selectedMember = member;\r\n      this.showDeleteModal = true;\r\n    },\r\n\r\n    // ลบสมาชิก\r\n    async deleteMember() {\r\n      try {\r\n        await api.deleteMember(this.selectedMember.member_id);\r\n        alert('ลบข้อมูลสมาชิกเรียบร้อยแล้ว');\r\n        this.showDeleteModal = false;\r\n        this.loadMembers();\r\n      } catch (error) {\r\n        console.error('Error deleting member:', error);\r\n        alert('ไม่สามารถลบข้อมูลสมาชิกได้');\r\n      }\r\n    },\r\n\r\n    // ปิดฟอร์ม\r\n    closeForm() {\r\n      this.showAddForm = false;\r\n      this.isEditing = false;\r\n      this.formData = {\r\n        first_name: '',\r\n        last_name: '',\r\n        phone: '',\r\n        bank_name: '',\r\n        bank_account: '',\r\n        national_id: '',\r\n        address_line1: '',\r\n        subdistrict: '',\r\n        district: '',\r\n        province: '',\r\n        postal_code: '',\r\n        id_card_copy: '',\r\n        house_registration_copy: '',\r\n        birth_date: \"\",\r\n        balance: 0\r\n        \r\n      };\r\n    },\r\n\r\n    // จัดรูปแบบที่อยู่\r\n    formatAddress(member) {\r\n      let address = member.address_line1 || '';\r\n      if (member.subdistrict) {\r\n        address += ` ต.${member.subdistrict}`;\r\n      }\r\n      if (member.district) {\r\n        address += ` อ.${member.district}`;\r\n      }\r\n      if (member.province) {\r\n        address += ` จ.${member.province}`;\r\n      }\r\n      if (member.postal_code) {\r\n        address += ` ${member.postal_code}`;\r\n      }\r\n      return address;\r\n    },\r\n\r\n    // จัดรูปแบบวันที่\r\n    formatDate(dateString) {\r\n      if (!dateString) return '-';\r\n      const date = new Date(dateString);\r\n      return new Intl.DateTimeFormat('th-TH', {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit'\r\n      }).format(date);\r\n    },\r\n\r\n    // จัดรูปแบบเงิน\r\n    formatCurrency(amount) {\r\n      return new Intl.NumberFormat('th-TH', {\r\n        style: 'currency',\r\n        currency: 'THB'\r\n      }).format(amount || 0);\r\n    },\r\n\r\n    // พิมพ์ PDF\r\n    async printPDF() {\r\n      const doc = new jsPDF(\"p\", \"mm\", \"a4\");\r\n\r\n      // กำหนดเส้นทางไฟล์ฟอนต์ที่ถูกต้องจาก public\r\n      const fontUrl = '/THSarabunNew.ttf'; // เส้นทางที่เข้าถึงไฟล์จาก public\r\n\r\n      // ฟอนต์ที่คุณต้องการใช้ใน jsPDF\r\n      const fontName = \"THSarabun\";\r\n\r\n      // เพิ่มฟอนต์จาก public (ใช้ addFileToVFS เพื่อให้ jsPDF รับรู้ฟอนต์)\r\n      await doc.addFileToVFS(fontName, fontUrl);\r\n      doc.addFont(fontUrl, fontName, \"normal\");  // เพิ่มฟอนต์ให้กับ jsPDF\r\n      doc.setFont(fontName);  // กำหนดฟอนต์ที่ต้องการใช้\r\n\r\n      // เพิ่มเนื้อหาลงใน PDF\r\n      doc.setFontSize(18);\r\n      doc.text(\"รายละเอียดสมาชิก\", 15, 20);\r\n\r\n      // เริ่มข้อมูลสมาชิก\r\n      doc.setFontSize(12);\r\n      let y = 30;\r\n\r\n\r\n    const addText = (label, value) => {\r\n    //  doc.setFont(\"THSarabun\", \"bold\");\r\n      doc.text(`${label}: `, 15, y);\r\n     // doc.setFont(\"THSarabun\", \"normal\");\r\n      doc.text(value ? value.toString() : \"-\", 55, y);\r\n      y += 8;\r\n    };\r\n\r\n      addText(\"รหัสสมาชิก\", this.selectedMember.member_id);\r\n      addText(\"ชื่อ-นามสกุล\", `${this.selectedMember.first_name} ${this.selectedMember.last_name}`);\r\n      addText(\"เบอร์โทรศัพท์\", this.selectedMember.phone);\r\n      addText(\"ธนาคาร\", this.selectedMember.bank_name);\r\n      addText(\"เลขบัญชี\", this.selectedMember.bank_account);\r\n      addText(\"เลขบัตรประชาชน\", this.selectedMember.national_id);\r\n      addText(\"ที่อยู่\", this.formatAddress(this.selectedMember));\r\n      addText(\"ยอดคงเหลือ\", this.formatCurrency(this.selectedMember.balance));\r\n      addText(\"ผู้สร้างข้อมูล\", this.selectedMember.created_by);\r\n      addText(\"วันที่สร้างข้อมูล\", this.formatDate(this.selectedMember.created_at));\r\n      addText(\"ผู้แก้ไขล่าสุด\", this.selectedMember.updated_by);\r\n      addText(\"วันที่แก้ไขล่าสุด\", this.formatDate(this.selectedMember.updated_at));\r\n\r\n      // เพิ่มรูปภาพ (สำเนาบัตรประชาชน & ทะเบียนบ้าน)\r\nconst addImage = async (imgSrc, label) => {\r\n  if (imgSrc) {\r\n    try {\r\n      const img = await this.loadImage(imgSrc);\r\n      doc.setFont(\"THSarabun\", \"bold\");\r\n      doc.text(label, 15, y + 5);\r\n      doc.addImage(img, \"JPEG\", 15, y + 10, 80, 50);  // ใช้ Base64 ที่ได้\r\n      y += 65;\r\n    } catch (error) {\r\n      console.error(`โหลดรูป ${label} ไม่สำเร็จ`, error);\r\n    }\r\n  }\r\n};\r\n\r\n      await addImage(this.selectedMember.id_card_copy, \"สำเนาบัตรประชาชน\");\r\n      await addImage(this.selectedMember.house_registration_copy, \"สำเนาทะเบียนบ้าน\");\r\n\r\n      // บันทึกไฟล์ PDF\r\n      doc.save(`Member_${this.selectedMember.member_id}.pdf`);\r\n      \r\n    },\r\n\r\n    // โหลดรูปภาพ\r\nloadImage(src) {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image();\r\n    img.crossOrigin = \"Anonymous\";  // รองรับการดึงภาพจากโดเมนต่าง ๆ\r\n    img.src = `http://localhost:8080/uploads/${src}`;  // ปรับ URL ตามที่เซิร์ฟเวอร์สามารถเข้าถึงได้\r\n    img.onload = () => {\r\n      const canvas = document.createElement(\"canvas\");\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      const ctx = canvas.getContext(\"2d\");\r\n      ctx.drawImage(img, 0, 0);\r\n      \r\n      // ตรวจสอบชนิดของไฟล์ และแปลงเป็น Base64 ตามประเภทของไฟล์\r\n      const fileExtension = src.split('.').pop().toLowerCase();\r\n      let mimeType = \"image/jpg\";  // Default เป็น JPEG\r\n\r\n      if (fileExtension === \"png\") {\r\n        mimeType = \"image/png\";  // หากเป็น PNG ให้ใช้ image/png\r\n      }\r\n\r\n      const base64Image = canvas.toDataURL(mimeType);\r\n      \r\n      // พิมพ์ Base64 ในคอนโซลเพื่อการตรวจสอบ\r\n      console.log(base64Image);\r\n\r\n      resolve(base64Image);\r\n    };\r\n    img.onerror = reject;\r\n  });\r\n}\r\n\r\n  },\r\n\r\n  created() {\r\n    this.loadMembers();\r\n  }\r\n};\r\n</script>\r\n\r\n\r\n\r\n\r\n<style scoped>\r\n/* สไตล์ทั่วไป */\r\n.member-container {\r\n  font-family: 'Sarabun', sans-serif;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  color: #333;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\nh1 {\r\n  color: #2c3e50;\r\n  font-size: 28px;\r\n  margin: 0;\r\n}\r\n\r\n/* สไตล์ปุ่ม */\r\nbutton {\r\n  cursor: pointer;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 8px 16px;\r\n  font-size: 14px;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.btn-add {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  padding: 10px 20px;\r\n  font-size: 16px;\r\n}\r\n\r\n.btn-add:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n.btn-view {\r\n  background-color: #2196F3;\r\n  color: white;\r\n  margin-right: 5px;\r\n}\r\n\r\n.btn-view:hover {\r\n  background-color: #0b7dda;\r\n}\r\n\r\n.btn-edit {\r\n  background-color: #FFC107;\r\n  color: #333;\r\n  margin-right: 5px;\r\n}\r\n\r\n.btn-edit:hover {\r\n  background-color: #e0a800;\r\n}\r\n\r\n.btn-delete {\r\n  background-color: #F44336;\r\n  color: white;\r\n}\r\n\r\n.btn-delete:hover {\r\n  background-color: #d32f2f;\r\n}\r\n\r\n.btn-cancel {\r\n  background-color: #9e9e9e;\r\n  color: white;\r\n  margin-right: 10px;\r\n}\r\n\r\n.btn-cancel:hover {\r\n  background-color: #757575;\r\n}\r\n\r\n.btn-submit {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  padding: 10px 20px;\r\n}\r\n\r\n.btn-submit:hover {\r\n  background-color: #45a049;\r\n}\r\n\r\n/* สไตล์ตาราง */\r\n.table-container {\r\n  background-color: #fff;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n  overflow: hidden;\r\n  margin-top: 20px;\r\n}\r\n\r\n.search-bar {\r\n  padding: 15px;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.search-bar input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n}\r\n\r\n.member-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.member-table th {\r\n  background-color: #3f51b5;\r\n  color: white;\r\n  text-align: left;\r\n  padding: 12px 15px;\r\n  font-weight: 500;\r\n}\r\n\r\n.member-table td {\r\n  padding: 12px 15px;\r\n  border-bottom: 1px solid #ddd;\r\n}\r\n\r\n.member-table tr:hover {\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.member-table .actions {\r\n  white-space: nowrap;\r\n}\r\n\r\n.no-data {\r\n  text-align: center;\r\n  padding: 30px;\r\n  color: #757575;\r\n}\r\n\r\n/* สไตล์ Modal */\r\n.modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background-color: #fff;\r\n  border-radius: 8px;\r\n  width: 80%;\r\n  max-width: 800px;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.delete-modal {\r\n  max-width: 500px;\r\n}\r\n\r\n.modal-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 15px 20px;\r\n  border-bottom: 1px solid #ddd;\r\n  background-color: #f5f5f5;\r\n}\r\n\r\n.modal-header h2 {\r\n  margin: 0;\r\n  color: #333;\r\n  font-size: 20px;\r\n}\r\n\r\n.close {\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  color: #757575;\r\n  cursor: pointer;\r\n}\r\n\r\n.close:hover {\r\n  color: #333;\r\n}\r\n\r\n.modal-body {\r\n  padding: 20px;\r\n}\r\n\r\n/* สไตล์ฟอร์ม */\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.form-row {\r\n  display: flex;\r\n  gap: 15px;\r\n}\r\n\r\n.form-group.half {\r\n  flex: 1;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: 500;\r\n  color: #333;\r\n}\r\n\r\n.required {\r\n  color: #F44336;\r\n}\r\n\r\ninput[type=\"text\"],\r\ninput[type=\"number\"],\r\nselect,\r\ntextarea {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  font-size: 16px;\r\n  transition: border-color 0.3s;\r\n}\r\n\r\ninput[type=\"text\"]:focus,\r\ninput[type=\"number\"]:focus,\r\nselect:focus,\r\ntextarea:focus {\r\n  border-color: #3f51b5;\r\n  outline: none;\r\n}\r\n\r\ntextarea {\r\n  min-height: 100px;\r\n  resize: vertical;\r\n}\r\n\r\n.preview {\r\n  margin-top: 10px;\r\n}\r\n\r\n.preview img {\r\n  max-width: 200px;\r\n  max-height: 150px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin-top: 20px;\r\n}\r\n\r\n/* สไตล์รายละเอียดสมาชิก */\r\n.member-details {\r\n  display: grid;\r\n  grid-template-columns: 1fr;\r\n  gap: 15px;\r\n}\r\n\r\n.detail-row {\r\n  display: flex;\r\n  border-bottom: 1px solid #eee;\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.detail-label {\r\n  font-weight: 500;\r\n  width: 180px;\r\n  color: #555;\r\n}\r\n\r\n.detail-value {\r\n  flex: 1;\r\n}\r\n\r\n.document-preview {\r\n  max-width: 300px;\r\n  max-height: 200px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  margin-top: 5px;\r\n}\r\n\r\n/* Responsive */\r\n@media (max-width: 768px) {\r\n  .form-row {\r\n    flex-direction: column;\r\n    gap: 0;\r\n  }\r\n  \r\n  .modal-content {\r\n    width: 95%;\r\n  }\r\n  \r\n  .member-table {\r\n    display: block;\r\n    overflow-x: auto;\r\n  }\r\n  \r\n  .header {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n  }\r\n  \r\n  .btn-add {\r\n    margin-top: 10px;\r\n  }\r\n  \r\n  .detail-row {\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .detail-label {\r\n    width: 100%;\r\n    margin-bottom: 5px;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}