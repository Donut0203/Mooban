{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, vModelText as _vModelText, withDirectives as _withDirectives, vModelSelect as _vModelSelect, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"pending-users\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"error\"\n};\nconst _hoisted_4 = {\n  key: 2\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"no-users\"\n};\nconst _hoisted_6 = {\n  key: 1,\n  class: \"users-table\"\n};\nconst _hoisted_7 = [\"onClick\", \"disabled\"];\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  key: 3,\n  class: \"modal\"\n};\nconst _hoisted_11 = {\n  class: \"modal-content\"\n};\nconst _hoisted_12 = {\n  class: \"form-group\"\n};\nconst _hoisted_13 = {\n  class: \"form-group\"\n};\nconst _hoisted_14 = {\n  class: \"form-group\"\n};\nconst _hoisted_15 = {\n  class: \"form-group\"\n};\nconst _hoisted_16 = {\n  class: \"form-group\"\n};\nconst _hoisted_17 = {\n  class: \"form-group\"\n};\nconst _hoisted_18 = {\n  class: \"modal-buttons\"\n};\nconst _hoisted_19 = {\n  type: \"submit\",\n  class: \"save-btn\"\n};\nconst _hoisted_20 = {\n  key: 4,\n  class: \"modal\"\n};\nconst _hoisted_21 = {\n  class: \"modal-content\"\n};\nconst _hoisted_22 = {\n  class: \"modal-buttons\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[23] || (_cache[23] = _createElementVNode(\"h1\", null, \"ผู้ใช้ที่รอการอนุมัติ\", -1 /* HOISTED */)), $data.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _cache[12] || (_cache[12] = [_createElementVNode(\"div\", {\n    class: \"loading-spinner\"\n  }, null, -1 /* HOISTED */), _createElementVNode(\"div\", {\n    class: \"loading-text\"\n  }, \"กำลังโหลดข้อมูล...\", -1 /* HOISTED */)]))) : $data.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _toDisplayString($data.error), 1 /* TEXT */)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [$data.pendingUsers.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \" ยังไม่มีผู้ใช้ที่รอการยืนยัน \")) : (_openBlock(), _createElementBlock(\"table\", _hoisted_6, [_cache[13] || (_cache[13] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"รหัส\"), _createElementVNode(\"th\", null, \"อีเมล\"), _createElementVNode(\"th\", null, \"ชื่อ-นามสกุล\"), _createElementVNode(\"th\", null, \"เบอร์โทรศัพท์\"), _createElementVNode(\"th\", null, \"สถานะ\"), _createElementVNode(\"th\", null, \"วันที่สร้าง\"), _createElementVNode(\"th\", null, \"การดำเนินการ\")])], -1 /* HOISTED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.pendingUsers, user => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: user.user_id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(user.user_id), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(user.user_email), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(user.first_name) + \" \" + _toDisplayString(user.last_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(user.phone), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(user.status), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($options.formatDate(user.created_at)), 1 /* TEXT */), _createElementVNode(\"td\", null, [$options.isHeadmanOrAssistant ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      onClick: $event => $options.approveUser(user.user_id),\n      class: \"approve-btn\",\n      disabled: !$options.isValidStatus(user.status)\n    }, \"ยืนยัน\", 8 /* PROPS */, _hoisted_7)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n      onClick: $event => $options.editUser(user),\n      class: \"edit-btn\"\n    }, \"แก้ไข\", 8 /* PROPS */, _hoisted_8), $options.isHeadmanOrAssistant ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 1,\n      onClick: $event => $options.confirmDelete(user.user_id),\n      class: \"delete-btn\"\n    }, \"ลบ\", 8 /* PROPS */, _hoisted_9)) : _createCommentVNode(\"v-if\", true)])]);\n  }), 128 /* KEYED_FRAGMENT */))])]))])), _createCommentVNode(\" Edit User Modal \"), $data.showEditModal ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"span\", {\n    class: \"close\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.closeEditModal && $options.closeEditModal(...args))\n  }, \"×\"), _createElementVNode(\"h2\", null, _toDisplayString($data.editingUser.approveAfterSave ? 'แก้ไขและยืนยันผู้ใช้' : $data.editingUser.user_id ? 'แก้ไขผู้ใช้' : 'เพิ่มผู้ใช้'), 1 /* TEXT */), _createElementVNode(\"form\", {\n    onSubmit: _cache[8] || (_cache[8] = _withModifiers((...args) => $options.saveUser && $options.saveUser(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_12, [_cache[14] || (_cache[14] = _createElementVNode(\"label\", {\n    for: \"firstName\"\n  }, \"ชื่อ\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"firstName\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.editingUser.first_name = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editingUser.first_name]])]), _createElementVNode(\"div\", _hoisted_13, [_cache[15] || (_cache[15] = _createElementVNode(\"label\", {\n    for: \"lastName\"\n  }, \"นามสกุล\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"lastName\",\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.editingUser.last_name = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editingUser.last_name]])]), _createElementVNode(\"div\", _hoisted_14, [_cache[16] || (_cache[16] = _createElementVNode(\"label\", {\n    for: \"email\"\n  }, \"อีเมล\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.editingUser.user_email = $event),\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editingUser.user_email]])]), _createElementVNode(\"div\", _hoisted_15, [_cache[17] || (_cache[17] = _createElementVNode(\"label\", {\n    for: \"phone\"\n  }, \"เบอร์โทรศัพท์\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"phone\",\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.editingUser.phone = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editingUser.phone]])]), _createElementVNode(\"div\", _hoisted_16, [_cache[18] || (_cache[18] = _createElementVNode(\"label\", {\n    for: \"address\"\n  }, \"ที่อยู่\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    id: \"address\",\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $data.editingUser.address = $event)\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editingUser.address]])]), _createElementVNode(\"div\", _hoisted_17, [_cache[20] || (_cache[20] = _createElementVNode(\"label\", {\n    for: \"status\"\n  }, \"สถานะ\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"select\", {\n    id: \"status\",\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $data.editingUser.status = $event)\n  }, _cache[19] || (_cache[19] = [_createElementVNode(\"option\", {\n    value: \"pending\"\n  }, \"รอการอนุมัติ\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"villager\"\n  }, \"ชาวบ้าน\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"assistant\"\n  }, \"ผู้ช่วย\", -1 /* HOISTED */), _createElementVNode(\"option\", {\n    value: \"headman\"\n  }, \"ผู้ใหญ่บ้าน\", -1 /* HOISTED */)]), 512 /* NEED_PATCH */), [[_vModelSelect, $data.editingUser.status]])]), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"cancel-btn\",\n    onClick: _cache[7] || (_cache[7] = (...args) => $options.closeEditModal && $options.closeEditModal(...args))\n  }, \"ยกเลิก\"), _createElementVNode(\"button\", _hoisted_19, _toDisplayString($data.editingUser.approveAfterSave ? 'บันทึกและยืนยัน' : 'บันทึก'), 1 /* TEXT */)])], 32 /* NEED_HYDRATION */)])])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Confirm Delete Modal \"), $data.showDeleteModal ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"span\", {\n    class: \"close\",\n    onClick: _cache[9] || (_cache[9] = (...args) => $options.closeDeleteModal && $options.closeDeleteModal(...args))\n  }, \"×\"), _cache[21] || (_cache[21] = _createElementVNode(\"h2\", null, \"ยืนยันการลบ\", -1 /* HOISTED */)), _cache[22] || (_cache[22] = _createElementVNode(\"p\", null, \"คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้นี้?\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"cancel-btn\",\n    onClick: _cache[10] || (_cache[10] = (...args) => $options.closeDeleteModal && $options.closeDeleteModal(...args))\n  }, \"ยกเลิก\"), _createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"delete-btn\",\n    onClick: _cache[11] || (_cache[11] = (...args) => $options.deleteUser && $options.deleteUser(...args))\n  }, \"ลบ\")])])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","key","type","_createElementBlock","_hoisted_1","_createElementVNode","$data","loading","_hoisted_2","_cache","error","_hoisted_3","_toDisplayString","_hoisted_4","pendingUsers","length","_hoisted_5","_hoisted_6","_Fragment","_renderList","user","user_id","user_email","first_name","last_name","phone","status","$options","formatDate","created_at","isHeadmanOrAssistant","onClick","$event","approveUser","disabled","isValidStatus","_hoisted_7","_createCommentVNode","editUser","_hoisted_8","confirmDelete","_hoisted_9","showEditModal","_hoisted_10","_hoisted_11","args","closeEditModal","editingUser","approveAfterSave","onSubmit","_withModifiers","saveUser","_hoisted_12","for","id","required","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","address","_hoisted_17","value","_hoisted_18","_hoisted_19","showDeleteModal","_hoisted_20","_hoisted_21","closeDeleteModal","_hoisted_22","deleteUser"],"sources":["C:\\Users\\HP\\Documents\\mooban4\\frontend\\src\\views\\PendingUsersView.vue"],"sourcesContent":["<template>\r\n  <div class=\"pending-users\">\r\n    <h1>ผู้ใช้ที่รอการอนุมัติ</h1>\r\n    <div v-if=\"loading\" class=\"loading\">\r\n      <div class=\"loading-spinner\"></div>\r\n      <div class=\"loading-text\">กำลังโหลดข้อมูล...</div>\r\n    </div>\r\n    <div v-else-if=\"error\" class=\"error\">{{ error }}</div>\r\n    <div v-else>\r\n      <div v-if=\"pendingUsers.length === 0\" class=\"no-users\">\r\n        ยังไม่มีผู้ใช้ที่รอการยืนยัน\r\n      </div>\r\n      <table v-else class=\"users-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>รหัส</th>\r\n            <th>อีเมล</th>\r\n            <th>ชื่อ-นามสกุล</th>\r\n            <th>เบอร์โทรศัพท์</th>\r\n            <th>สถานะ</th>\r\n            <th>วันที่สร้าง</th>\r\n            <th>การดำเนินการ</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"user in pendingUsers\" :key=\"user.user_id\">\r\n            <td>{{ user.user_id }}</td>\r\n            <td>{{ user.user_email }}</td>\r\n            <td>{{ user.first_name }} {{ user.last_name }}</td>\r\n            <td>{{ user.phone }}</td>\r\n            <td>{{ user.status }}</td>\r\n            <td>{{ formatDate(user.created_at) }}</td>\r\n            <td>\r\n              <button v-if=\"isHeadmanOrAssistant\" @click=\"approveUser(user.user_id)\" class=\"approve-btn\" :disabled=\"!isValidStatus(user.status)\">ยืนยัน</button>\r\n              <button @click=\"editUser(user)\" class=\"edit-btn\">แก้ไข</button>\r\n              <button v-if=\"isHeadmanOrAssistant\" @click=\"confirmDelete(user.user_id)\" class=\"delete-btn\">ลบ</button>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <!-- Edit User Modal -->\r\n    <div v-if=\"showEditModal\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close\" @click=\"closeEditModal\">&times;</span>\r\n        <h2>{{ editingUser.approveAfterSave ? 'แก้ไขและยืนยันผู้ใช้' : (editingUser.user_id ? 'แก้ไขผู้ใช้' : 'เพิ่มผู้ใช้') }}</h2>\r\n        <form @submit.prevent=\"saveUser\">\r\n          <div class=\"form-group\">\r\n            <label for=\"firstName\">ชื่อ</label>\r\n            <input type=\"text\" id=\"firstName\" v-model=\"editingUser.first_name\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"lastName\">นามสกุล</label>\r\n            <input type=\"text\" id=\"lastName\" v-model=\"editingUser.last_name\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"email\">อีเมล</label>\r\n            <input type=\"email\" id=\"email\" v-model=\"editingUser.user_email\" required>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"phone\">เบอร์โทรศัพท์</label>\r\n            <input type=\"text\" id=\"phone\" v-model=\"editingUser.phone\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"address\">ที่อยู่</label>\r\n            <input type=\"text\" id=\"address\" v-model=\"editingUser.address\">\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"status\">สถานะ</label>\r\n            <select id=\"status\" v-model=\"editingUser.status\">\r\n              <option value=\"pending\">รอการอนุมัติ</option>\r\n              <option value=\"villager\">ชาวบ้าน</option>\r\n              <option value=\"assistant\">ผู้ช่วย</option>\r\n              <option value=\"headman\">ผู้ใหญ่บ้าน</option>\r\n            </select>\r\n          </div>\r\n          <div class=\"modal-buttons\">\r\n            <button type=\"button\" class=\"cancel-btn\" @click=\"closeEditModal\">ยกเลิก</button>\r\n            <button type=\"submit\" class=\"save-btn\">{{ editingUser.approveAfterSave ? 'บันทึกและยืนยัน' : 'บันทึก' }}</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Confirm Delete Modal -->\r\n    <div v-if=\"showDeleteModal\" class=\"modal\">\r\n      <div class=\"modal-content\">\r\n        <span class=\"close\" @click=\"closeDeleteModal\">&times;</span>\r\n        <h2>ยืนยันการลบ</h2>\r\n        <p>คุณแน่ใจหรือไม่ว่าต้องการลบผู้ใช้นี้?</p>\r\n        <div class=\"modal-buttons\">\r\n          <button type=\"button\" class=\"cancel-btn\" @click=\"closeDeleteModal\">ยกเลิก</button>\r\n          <button type=\"button\" class=\"delete-btn\" @click=\"deleteUser\">ลบ</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/services/api';\r\n\r\nexport default {\r\n  name: 'PendingUsersView',\r\n  data() {\r\n    return {\r\n      pendingUsers: [],\r\n      loading: true,\r\n      error: null,\r\n      showEditModal: false,\r\n      showDeleteModal: false,\r\n      editingUser: {\r\n        user_id: null,\r\n        first_name: '',\r\n        last_name: '',\r\n        user_email: '',\r\n        phone: '',\r\n        address: '',\r\n        status: 'pending',\r\n        approveAfterSave: false\r\n      },\r\n      userToDelete: null,\r\n      currentUserStatus: localStorage.getItem('userStatus') || ''\r\n    };\r\n  },\r\n  computed: {\r\n    isHeadmanOrAssistant() {\r\n      return this.currentUserStatus === 'headman' || this.currentUserStatus === 'assistant';\r\n    }\r\n  },\r\n  created() {\r\n    // Load data immediately\r\n    this.loadPendingUsers();\r\n  },\r\n  methods: {\r\n    isValidStatus(status) {\r\n      // Check if status is one of the valid statuses\r\n      return ['headman', 'assistant', 'villager'].includes(status);\r\n    },\r\n    async loadPendingUsers() {\r\n      this.loading = true;\r\n      this.error = null;\r\n\r\n      try {\r\n        console.log('Loading pending users...');\r\n\r\n        // First, get all pending users from the API\r\n        const pendingResponse = await api.getPendingUsers();\r\n        let pendingUsers = [];\r\n\r\n        if (pendingResponse.data && pendingResponse.data.pendingUsers) {\r\n          pendingUsers = pendingResponse.data.pendingUsers;\r\n        }\r\n\r\n        // Then, get all users to find any with 'pending' status\r\n        const allUsersResponse = await api.getAllUsers();\r\n        let allUsers = [];\r\n\r\n        if (allUsersResponse.data && allUsersResponse.data.users) {\r\n          // Filter users with 'pending' status\r\n          const pendingStatusUsers = allUsersResponse.data.users.filter(user =>\r\n            user.status === 'pending'\r\n          );\r\n\r\n          // Combine both lists, avoiding duplicates by user_id\r\n          const combinedUsers = [...pendingUsers];\r\n\r\n          pendingStatusUsers.forEach(user => {\r\n            // Check if this user is already in the combined list\r\n            const isDuplicate = combinedUsers.some(existingUser =>\r\n              existingUser.user_id === user.user_id\r\n            );\r\n\r\n            // If not a duplicate, add to the combined list\r\n            if (!isDuplicate) {\r\n              combinedUsers.push(user);\r\n            }\r\n          });\r\n\r\n          this.pendingUsers = combinedUsers;\r\n        } else {\r\n          // If we couldn't get all users, just use the pending users\r\n          this.pendingUsers = pendingUsers;\r\n        }\r\n\r\n        console.log('Combined pending users:', this.pendingUsers);\r\n\r\n        if (this.pendingUsers.length === 0) {\r\n          // If no data or empty array, set empty array\r\n          this.pendingUsers = [];\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading pending users:', error);\r\n        // Set empty array instead of using sample data\r\n        this.pendingUsers = [];\r\n      } finally {\r\n        // Always set loading to false\r\n        this.loading = false;\r\n      }\r\n    },\r\n\r\n    // useSampleData function has been removed as we now show \"no users\" message instead\r\n    \r\n    formatDate(dateString) {\r\n      if (!dateString) return '';\r\n      const date = new Date(dateString);\r\n      return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();\r\n    },\r\n    \r\n    async approveUser(userId) {\r\n      // Check if user has permission to approve\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการอนุมัติผู้ใช้ กรุณาติดต่อผู้ดูแลระบบ');\r\n        return;\r\n      }\r\n\r\n      // Find the user to check their status\r\n      const userToApprove = this.pendingUsers.find(user => user.user_id === userId);\r\n\r\n      if (!userToApprove) {\r\n        alert('ไม่พบข้อมูลผู้ใช้');\r\n        return;\r\n      }\r\n\r\n      // Check if user has a valid status\r\n      if (!this.isValidStatus(userToApprove.status)) {\r\n        alert('ไม่สามารถอนุมัติผู้ใช้ได้ เนื่องจากสถานะไม่ถูกต้อง กรุณาแก้ไขสถานะให้เป็น headman, assistant หรือ villager ก่อน');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        await api.approveUser(userId);\r\n\r\n        alert('อนุมัติผู้ใช้เรียบร้อยแล้ว');\r\n        this.loadPendingUsers();\r\n      } catch (error) {\r\n        console.error('Error approving user:', error);\r\n        alert('ไม่สามารถอนุมัติผู้ใช้ได้ กรุณาลองอีกครั้ง');\r\n      }\r\n    },\r\n    \r\n    editAndApprove(user) {\r\n      // Check if user has permission to approve\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการอนุมัติผู้ใช้ กรุณาติดต่อผู้ดูแลระบบ');\r\n        return;\r\n      }\r\n\r\n      this.editingUser = { ...user };\r\n      // Set a flag to indicate that we want to approve after saving\r\n      this.editingUser.approveAfterSave = true;\r\n      this.showEditModal = true;\r\n    },\r\n\r\n    editUser(user) {\r\n      this.editingUser = { ...user };\r\n      this.editingUser.approveAfterSave = false;\r\n      this.showEditModal = true;\r\n    },\r\n    \r\n    closeEditModal() {\r\n      this.showEditModal = false;\r\n      this.editingUser = {\r\n        user_id: null,\r\n        first_name: '',\r\n        last_name: '',\r\n        user_email: '',\r\n        phone: '',\r\n        address: '',\r\n        status: 'pending',\r\n        approveAfterSave: false\r\n      };\r\n    },\r\n    \r\n    async saveUser() {\r\n      try {\r\n        const userId = this.editingUser.user_id;\r\n        const shouldApprove = this.editingUser.approveAfterSave;\r\n\r\n        // Check if user has permission to approve\r\n        if (shouldApprove && !this.isHeadmanOrAssistant) {\r\n          alert('คุณไม่มีสิทธิ์ในการอนุมัติผู้ใช้ กรุณาติดต่อผู้ดูแลระบบ');\r\n          return;\r\n        }\r\n\r\n        if (userId) {\r\n          // Update existing user\r\n          await api.updateUser(userId, {\r\n            firstName: this.editingUser.first_name,\r\n            lastName: this.editingUser.last_name,\r\n            email: this.editingUser.user_email,\r\n            phone: this.editingUser.phone,\r\n            address: this.editingUser.address,\r\n            status: this.editingUser.status\r\n          });\r\n        } else {\r\n          // Add new user\r\n          await api.register({\r\n            firstName: this.editingUser.first_name,\r\n            lastName: this.editingUser.last_name,\r\n            email: this.editingUser.user_email,\r\n            phone: this.editingUser.phone,\r\n            address: this.editingUser.address,\r\n            status: this.editingUser.status,\r\n            password: 'Password123' // Default password\r\n          });\r\n        }\r\n\r\n        // Check if we need to approve the user after saving\r\n        if (shouldApprove && userId && this.isHeadmanOrAssistant) {\r\n          // Approve the user\r\n          await api.approveUser(userId);\r\n\r\n          this.closeEditModal();\r\n          this.loadPendingUsers();\r\n          alert('อัปเดตและอนุมัติผู้ใช้เรียบร้อยแล้ว');\r\n        } else {\r\n          this.closeEditModal();\r\n          this.loadPendingUsers();\r\n          alert(userId ? 'อัปเดตผู้ใช้เรียบร้อยแล้ว' : 'เพิ่มผู้ใช้เรียบร้อยแล้ว');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error saving user:', error);\r\n        alert('ไม่สามารถบันทึกข้อมูลผู้ใช้ได้ กรุณาลองอีกครั้ง');\r\n      }\r\n    },\r\n    \r\n    confirmDelete(userId) {\r\n      // Check if user has permission to delete\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการลบผู้ใช้ กรุณาติดต่อผู้ดูแลระบบ');\r\n        return;\r\n      }\r\n\r\n      this.userToDelete = userId;\r\n      this.showDeleteModal = true;\r\n    },\r\n    \r\n    closeDeleteModal() {\r\n      this.showDeleteModal = false;\r\n      this.userToDelete = null;\r\n    },\r\n    \r\n    async deleteUser() {\r\n      if (!this.userToDelete) return;\r\n\r\n      // Check if user has permission to delete\r\n      if (!this.isHeadmanOrAssistant) {\r\n        alert('คุณไม่มีสิทธิ์ในการลบผู้ใช้ กรุณาติดต่อผู้ดูแลระบบ');\r\n        this.closeDeleteModal();\r\n        return;\r\n      }\r\n\r\n      try {\r\n        await api.deleteUser(this.userToDelete);\r\n\r\n        this.closeDeleteModal();\r\n        this.loadPendingUsers();\r\n        alert('ลบผู้ใช้เรียบร้อยแล้ว');\r\n      } catch (error) {\r\n        console.error('Error deleting user:', error);\r\n        alert('ไม่สามารถลบผู้ใช้ได้ กรุณาลองอีกครั้ง');\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.pending-users {\r\n  padding: 20px;\r\n}\r\n\r\n.loading {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 50px 0;\r\n  padding: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 50px;\r\n  height: 50px;\r\n  border: 5px solid #f3f3f3;\r\n  border-top: 5px solid #3498db;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.loading-text {\r\n  font-size: 18px;\r\n  color: #666;\r\n}\r\n\r\n.error, .no-users {\r\n  margin: 20px 0;\r\n  padding: 10px;\r\n  text-align: center;\r\n}\r\n\r\n.error {\r\n  color: red;\r\n  border: 1px solid red;\r\n  border-radius: 4px;\r\n}\r\n\r\n.users-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 20px;\r\n}\r\n\r\n.users-table th, .users-table td {\r\n  border: 1px solid #ddd;\r\n  padding: 8px;\r\n  text-align: left;\r\n}\r\n\r\n.users-table th {\r\n  background-color: #f2f2f2;\r\n}\r\n\r\n.users-table tr:nth-child(even) {\r\n  background-color: #f9f9f9;\r\n}\r\n\r\n.users-table tr:hover {\r\n  background-color: #f1f1f1;\r\n}\r\n\r\n.approve-btn, .edit-btn, .delete-btn, .save-btn, .cancel-btn, .edit-approve-btn {\r\n  padding: 5px 10px;\r\n  margin: 0 5px;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.approve-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.edit-approve-btn {\r\n  background-color: #FF9800;\r\n  color: white;\r\n}\r\n\r\n.edit-btn {\r\n  background-color: #2196F3;\r\n  color: white;\r\n}\r\n\r\n.delete-btn {\r\n  background-color: #f44336;\r\n  color: white;\r\n}\r\n\r\n.save-btn {\r\n  background-color: #4CAF50;\r\n  color: white;\r\n}\r\n\r\n.cancel-btn {\r\n  background-color: #f44336;\r\n  color: white;\r\n}\r\n\r\n/* Modal styles */\r\n.modal {\r\n  display: block;\r\n  position: fixed;\r\n  z-index: 1;\r\n  left: 0;\r\n  top: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: auto;\r\n  background-color: rgba(0,0,0,0.4);\r\n}\r\n\r\n.modal-content {\r\n  background-color: #fefefe;\r\n  margin: 15% auto;\r\n  padding: 20px;\r\n  border: 1px solid #888;\r\n  width: 80%;\r\n  max-width: 500px;\r\n  border-radius: 5px;\r\n}\r\n\r\n.close {\r\n  color: #aaa;\r\n  float: right;\r\n  font-size: 28px;\r\n  font-weight: bold;\r\n  cursor: pointer;\r\n}\r\n\r\n.close:hover,\r\n.close:focus {\r\n  color: black;\r\n  text-decoration: none;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.form-group label {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.form-group input, .form-group select {\r\n  width: 100%;\r\n  padding: 8px;\r\n  box-sizing: border-box;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n}\r\n\r\n.modal-buttons {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin-top: 20px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}